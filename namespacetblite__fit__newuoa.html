<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tblite: tblite_fit_newuoa Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">tblite
   </div>
   <div id="projectbrief">Light-weight tight-binding framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">tblite_fit_newuoa Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>NEWUOA: <b>NEW</b> **U**nconstrained **O**ptimization **A**lgorithm.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacetblite__fit__newuoa_1_1objective__function.html">objective_function</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7e79c943d1a70cc490ab46bcd0f8105f" id="r_a7e79c943d1a70cc490ab46bcd0f8105f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7e79c943d1a70cc490ab46bcd0f8105f">newuoa</a> (n, npt, x, rhobeg, rhoend, iprint, maxfun, calfun, handle, error)</td></tr>
<tr class="memdesc:a7e79c943d1a70cc490ab46bcd0f8105f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine seeks the least value of a function of many variables, by a trust region method that forms quadratic models by interpolation. There can be some freedom in the interpolation conditions, which is taken up by minimizing the Frobenius norm of the change to the second.  <br /></td></tr>
<tr class="separator:a7e79c943d1a70cc490ab46bcd0f8105f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>NEWUOA: <b>NEW</b> **U**nconstrained **O**ptimization **A**lgorithm. </p>
<p>The purpose of NEWUOA is to seek the least value of a function F of several variables, when derivatives are not available. The main new feature of the method is that quadratic models are updated using only about <code>NPT=2N+1</code> interpolation conditions, the remaining freedom being taken up by minimizing the Frobenius norm of the change to the second derivative matrix of the model.</p>
<p>The new software was developed from [[UOBYQA]], which also forms quadratic models from interpolation conditions. That method requires <code>NPT=(N+1)(N+2)/2</code> conditions, however, because they have to define all the parameters of the model. The least Frobenius norm updating procedure with <code>NPT=2N+1</code> is usually much more efficient when <code>N</code> is large, because the work of each iteration is much less than before, and in some experiments the number of calculations of the objective function seems to be only of magnitude <code>N</code>.</p>
<h1><a class="anchor" id="autotoc_md0"></a>
References</h1>
<ul>
<li>"[The NEWUOA software for unconstrained optimization without
    derivatives](http://www.damtp.cam.ac.uk/user/na/NA_papers/NA2004_08.pdf)", 2004/NA08</li>
<li>"[The NEWUOA software for unconstrained minimization
    without derivatives](http://link.springer.com/chapter/10.1007%2F0-387-30065-1_16)", in Large-Scale Nonlinear Optimization, editors G. Di Pillo and M. Roma, Springer (2006), pages 255-297.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
History</h1>
<ul>
<li>M.J.D. Powell, December 16th, 2004 : It is hoped that the software will be helpful to much future research and to many applications. There are no restrictions on or charges for its use.</li>
<li>Jacob Williams, July 2015 : refactoring of the code into modern Fortran.</li>
<li>Sebastian Ehlert, August 2021 : removed implicit typing</li>
</ul>
<div class="fragment"><div class="line">@Inbook{Powell2006,</div>
<div class="line">  author=,</div>
<div class="line">  editor=,</div>
<div class="line">  title=,</div>
<div class="line">  bookTitle=,</div>
<div class="line">  year=,</div>
<div class="line">  publisher=,</div>
<div class="line">  address=,</div>
<div class="line">  pages=,</div>
<div class="line">  url=</div>
<div class="line">}</div>
</div><!-- fragment --> </div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7e79c943d1a70cc490ab46bcd0f8105f" name="a7e79c943d1a70cc490ab46bcd0f8105f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e79c943d1a70cc490ab46bcd0f8105f">&#9670;&#160;</a></span>newuoa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public tblite_fit_newuoa::newuoa </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>npt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)</td>          <td class="paramname"><span class="paramname"><em>rhobeg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)</td>          <td class="paramname"><span class="paramname"><em>rhoend</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>iprint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxfun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(<a class="el" href="interfacetblite__fit__newuoa_1_1objective__function.html">objective_function</a>)</td>          <td class="paramname"><span class="paramname"><em>calfun</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(*), intent(in)</td>          <td class="paramname"><span class="paramname"><em>handle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(error_type), intent(out), allocatable</td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine seeks the least value of a function of many variables, by a trust region method that forms quadratic models by interpolation. There can be some freedom in the interpolation conditions, which is taken up by minimizing the Frobenius norm of the change to the second. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The number of variables. Must be at least 2. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npt</td><td>The number of interpolation conditions. Its value must be in the interval <code>[N+2, (N+1)(N+2)/2]</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>Initial values of the variables must be set in X(1), X(2), ..., X(N). They will be changed to the values that give the least calculated F. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhobeg</td><td>RHOBEG and RHOEND must be set to the initial and final values of a trust region radius, so both must be positive with RHOEND&lt;=RHOBEG. Typically RHOBEG should be about one tenth of the greatest expected change to a variable, and RHOEND should indicate the accuracy that is required in the final values of the variables. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhoend</td><td>RHOBEG and RHOEND must be set to the initial and final values of a trust region radius, so both must be positive with RHOEND&lt;=RHOBEG. Typically RHOBEG should be about one tenth of the greatest expected change to a variable, and RHOEND should indicate the accuracy that is required in the final values of the variables. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iprint</td><td>The value of IPRINT should be set to 0, 1, 2 or 3, which controls the amount of printing. Specifically, there is no output if IPRINT=0 and there is output only at the return if IPRINT=1. Otherwise, each new value of RHO is printed, with the best vector of variables so far and the corresponding value of the objective function. Further, each new value of F with its variables are output if IPRINT=3. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxfun</td><td>An upper bound on the number of calls of CALFUN. It must set F to the value of the objective function for the variables <code>X(1), X(2), ..., X(N)</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
