! This file is part of tblite.
! SPDX-Identifier: LGPL-3.0-or-later
!
! tblite is free software: you can redistribute it and/or modify it under
! the terms of the GNU Lesser General Public License as published by
! the Free Software Foundation, either version 3 of the License, or
! (at your option) any later version.
!
! tblite is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU Lesser General Public License for more details.
!
! You should have received a copy of the GNU Lesser General Public License
! along with tblite.  If not, see <https://www.gnu.org/licenses/>.

module test_integral_overlap
   use mctc_env, only : wp
   use mctc_env_testing, only : new_unittest, unittest_type, error_type, check, &
      & test_failed
   use mctc_io, only : structure_type
   use mstore, only : get_structure
   use tblite_basis_type
   use tblite_basis_slater, only : slater_to_gauss
   use tblite_cutoff, only : get_lattice_points
   use tblite_integral_overlap
   
   implicit none
   private

   public :: collect_integral_overlap

   real(wp), parameter :: thr = 5e+6_wp*epsilon(1.0_wp)
   real(wp), parameter :: thr2 = sqrt(epsilon(1.0_wp))

contains


!> Collect all exported unit tests
subroutine collect_integral_overlap(testsuite)

   !> Collection of tests
   type(unittest_type), allocatable, intent(out) :: testsuite(:)

   testsuite = [ &
      new_unittest("overlap-alh3", test_overlap_alh3), &
      new_unittest("overlap-diat-alh3", test_overlap_diat_alh3), &
      new_unittest("overlap-bh3", test_overlap_bh3), &
      new_unittest("overlap-beh2", test_overlap_beh2), &
      new_unittest("overlap-ch4", test_overlap_ch4), &
      new_unittest("overlap-cl2", test_overlap_cl2), &
      new_unittest("overlap-diat-cl2", test_overlap_diat_cl2), &
      new_unittest("overlap-f2", test_overlap_f2), &
      new_unittest("overlap-h2", test_overlap_h2), &
      new_unittest("overlap-lih", test_overlap_lih), &
      new_unittest("overlap-diat-cecl3", test_overlap_diat_cecl3), &
      new_unittest("overlap-grad-ss", test_overlap_grad_ss), &
      new_unittest("overlap-grad-pp", test_overlap_grad_pp), &
      new_unittest("overlap-grad-dd", test_overlap_grad_dd), &
      new_unittest("overlap-grad-ff", test_overlap_grad_ff), &
      new_unittest("overlap-diat-grad-ss", test_overlap_diat_grad_ss), &
      new_unittest("overlap-diat-grad-ss_z", test_overlap_diat_grad_ss_z), &
      new_unittest("overlap-diat-grad-sp", test_overlap_diat_grad_sp), &
      new_unittest("overlap-diat-grad-sp_z", test_overlap_diat_grad_sp_z), &
      new_unittest("overlap-diat-grad-pp", test_overlap_diat_grad_pp), &
      new_unittest("overlap-diat-grad-pp_z", test_overlap_diat_grad_pp_z), &
      new_unittest("overlap-diat-grad-sd", test_overlap_diat_grad_sd), &
      new_unittest("overlap-diat-grad-sd_z", test_overlap_diat_grad_sd_z), &
      new_unittest("overlap-diat-grad-pd", test_overlap_diat_grad_pd), &
      new_unittest("overlap-diat-grad-pd_z", test_overlap_diat_grad_pd_z), &
      new_unittest("overlap-diat-grad-dd", test_overlap_diat_grad_dd), &
      new_unittest("overlap-diat-grad-dd_z", test_overlap_diat_grad_dd_z), &
      new_unittest("overlap-diat-grad-sf", test_overlap_diat_grad_sf), &
      new_unittest("overlap-diat-grad-sf_z", test_overlap_diat_grad_sf_z), &
      new_unittest("overlap-diat-grad-pf", test_overlap_diat_grad_pf), &
      new_unittest("overlap-diat-grad-pf_z", test_overlap_diat_grad_pf_z), &
      new_unittest("overlap-diat-grad-df", test_overlap_diat_grad_df), &
      new_unittest("overlap-diat-grad-df_z", test_overlap_diat_grad_df_z), &
      new_unittest("overlap-diat-grad-ff", test_overlap_diat_grad_ff), & 
      new_unittest("overlap-diat-grad-ff_z", test_overlap_diat_grad_ff_z) & 
      ]

end subroutine collect_integral_overlap


subroutine make_basis(bas, mol, ng)
   type(basis_type), intent(out) :: bas
   type(structure_type), intent(in) :: mol
   integer, intent(in) :: ng


   integer, parameter :: nsh(86) = [&
   & 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 2, 3, & ! 1-20
   & 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, & ! 21-40
   & 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 4, 3, 3, & ! 41-60
   & 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, & ! 61-80
   & 3, 3, 3, 3, 3, 3]
   integer, parameter :: lsh(4, 86) = reshape([&
   & 0, 0, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0, & ! 1-6
   & 0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 0, 0,  0, 1, 2, 0, & ! 7-12 
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 13-18
   & 0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 19-24
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 0, 0, & ! 25-30
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 31-36
   & 0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 37-42
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 0, 0, & ! 43-48
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 49-54
   & 0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 3,  0, 1, 2, 0,  0, 1, 2, 0, & ! 55-60
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 61-66
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 67-72
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 73-78
   & 0, 1, 2, 0,  0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 79-84
   & 0, 1, 2, 0,  0, 1, 2, 0], &
      & shape(lsh))
   integer, parameter :: pqn(4, 86) = reshape([&
   & 1, 0, 0, 0,  1, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0, & ! 1-6
   & 2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 3, 0,  3, 3, 0, 0,  3, 3, 3, 0, & ! 7-12 
   & 3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0, & ! 13-18
   & 4, 4, 0, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0, & ! 19-24
   & 4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 0, 0, & ! 25-30
   & 4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0, & ! 31-36
   & 5, 5, 0, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0, & ! 37-42
   & 5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 0, 0, & ! 43-48
   & 5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0, & ! 49-54
   & 6, 6, 0, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 4,  6, 6, 5, 0,  6, 6, 5, 0, & ! 55-60
   & 6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 61-66
   & 6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 67-72
   & 6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 73-78
   & 6, 6, 5, 0,  6, 6, 0, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 79-84
   & 6, 6, 5, 0,  6, 6, 5, 0], &
      & shape(pqn))
   real(wp), parameter :: zeta(4, 86) = reshape([&
   & 1.230000_wp, 0.000000_wp, 0.000000_wp, 0.000000_wp, & 
   & 1.669667_wp, 1.500000_wp, 0.000000_wp, 0.000000_wp, & ! 2
   & 0.750060_wp, 0.557848_wp, 0.000000_wp, 0.000000_wp, &
   & 1.034720_wp, 0.949332_wp, 0.000000_wp, 0.000000_wp, &
   & 1.479444_wp, 1.479805_wp, 0.000000_wp, 0.000000_wp, &
   & 2.096432_wp, 1.800000_wp, 0.000000_wp, 0.000000_wp, &
   & 2.339881_wp, 2.014332_wp, 0.000000_wp, 0.000000_wp, &
   & 2.439742_wp, 2.137023_wp, 0.000000_wp, 0.000000_wp, &
   & 2.416361_wp, 2.308399_wp, 0.000000_wp, 0.000000_wp, &
   & 3.084104_wp, 2.312051_wp, 2.815609_wp, 0.000000_wp, & ! 10
   & 0.763787_wp, 0.573553_wp, 0.000000_wp, 0.000000_wp, &
   & 1.184203_wp, 0.717769_wp, 1.300000_wp, 0.000000_wp, &
   & 1.352531_wp, 1.391201_wp, 1.000000_wp, 0.000000_wp, &
   & 1.773917_wp, 1.718996_wp, 1.250000_wp, 0.000000_wp, &
   & 1.816945_wp, 1.903247_wp, 1.167533_wp, 0.000000_wp, &
   & 1.981333_wp, 2.025643_wp, 1.702555_wp, 0.000000_wp, &
   & 2.485265_wp, 2.199650_wp, 2.476089_wp, 0.000000_wp, &
   & 2.329679_wp, 2.149419_wp, 1.950531_wp, 0.000000_wp, & ! 18
   & 0.875961_wp, 0.631694_wp, 0.000000_wp, 0.000000_wp, & 
   & 1.267130_wp, 0.786247_wp, 1.380000_wp, 0.000000_wp, &
   & 2.224492_wp, 1.554183_wp, 2.009535_wp, 0.000000_wp, &
   & 2.588796_wp, 0.994410_wp, 1.885617_wp, 0.000000_wp, &
   & 3.043706_wp, 4.030076_wp, 1.663291_wp, 0.000000_wp, &
   & 2.250127_wp, 2.706815_wp, 1.675019_wp, 0.000000_wp, &
   & 2.206053_wp, 2.820197_wp, 1.861022_wp, 0.000000_wp, &
   & 1.572970_wp, 1.986214_wp, 2.837906_wp, 0.000000_wp, &
   & 1.808266_wp, 1.736758_wp, 2.797674_wp, 0.000000_wp, &
   & 2.007589_wp, 2.250756_wp, 2.982916_wp, 0.000000_wp, &
   & 2.181599_wp, 2.384590_wp, 3.095025_wp, 0.000000_wp, &
   & 2.263767_wp, 2.203629_wp, 0.000000_wp, 0.000000_wp, &
   & 2.638221_wp, 2.067523_wp, 2.113616_wp, 0.000000_wp, &
   & 2.528919_wp, 2.194417_wp, 1.776619_wp, 0.000000_wp, &
   & 3.556676_wp, 2.420754_wp, 1.465797_wp, 0.000000_wp, &
   & 2.896526_wp, 2.454218_wp, 2.278836_wp, 0.000000_wp, &
   & 3.289210_wp, 2.565269_wp, 1.645016_wp, 0.000000_wp, &
   & 5.209881_wp, 2.843367_wp, 2.758388_wp, 0.000000_wp, & ! 36
   & 1.269729_wp, 1.887305_wp, 0.000000_wp, 0.000000_wp, &
   & 1.868807_wp, 1.785463_wp, 2.160122_wp, 0.000000_wp, &
   & 0.920018_wp, 1.457324_wp, 2.229013_wp, 0.000000_wp, &
   & 6.506473_wp, 1.432023_wp, 2.119714_wp, 0.000000_wp, &
   & 2.109733_wp, 2.799447_wp, 2.018973_wp, 0.000000_wp, &
   & 2.584133_wp, 3.027953_wp, 2.087336_wp, 0.000000_wp, &
   & 2.621415_wp, 3.134876_wp, 2.132598_wp, 0.000000_wp, &
   & 2.739844_wp, 2.181678_wp, 2.546096_wp, 0.000000_wp, &
   & 1.840571_wp, 2.974826_wp, 3.106937_wp, 0.000000_wp, &
   & 1.756228_wp, 3.394247_wp, 3.202653_wp, 0.000000_wp, &
   & 3.050188_wp, 2.349519_wp, 3.353329_wp, 0.000000_wp, &
   & 2.419991_wp, 2.288929_wp, 0.000000_wp, 0.000000_wp, &
   & 2.878139_wp, 2.446597_wp, 2.757735_wp, 0.000000_wp, &
   & 3.038232_wp, 2.320821_wp, 1.775133_wp, 0.000000_wp, &
   & 2.687507_wp, 2.385653_wp, 2.125961_wp, 0.000000_wp, &
   & 2.810717_wp, 2.452747_wp, 2.018718_wp, 0.000000_wp, &
   & 2.906869_wp, 2.493771_wp, 1.900737_wp, 0.000000_wp, &
   & 4.175313_wp, 2.869379_wp, 2.968948_wp, 0.000000_wp, & ! 54
   & 1.242993_wp, 1.991420_wp, 0.000000_wp, 0.000000_wp, &
   & 1.314003_wp, 1.164384_wp, 2.127596_wp, 0.000000_wp, &
   & 2.817373_wp, 1.698633_wp, 2.273697_wp, 0.000000_wp, &
   & 2.845039_wp, 1.460181_wp, 2.534989_wp, 2.534989_wp, &
   & 2.816971_wp, 1.475453_wp, 2.543502_wp, 0.000000_wp, &
   & 2.788903_wp, 1.490724_wp, 2.552016_wp, 0.000000_wp, &
   & 2.760835_wp, 1.505995_wp, 2.560529_wp, 0.000000_wp, &
   & 2.732767_wp, 1.521266_wp, 2.569042_wp, 0.000000_wp, &
   & 2.704699_wp, 1.536537_wp, 2.577556_wp, 0.000000_wp, &
   & 2.676631_wp, 1.551808_wp, 2.586069_wp, 0.000000_wp, &
   & 2.648563_wp, 1.567079_wp, 2.594583_wp, 0.000000_wp, &
   & 2.620495_wp, 1.582351_wp, 2.603096_wp, 0.000000_wp, &
   & 2.592427_wp, 1.597622_wp, 2.611609_wp, 0.000000_wp, &
   & 2.564359_wp, 1.612893_wp, 2.620123_wp, 0.000000_wp, &
   & 2.536291_wp, 1.628164_wp, 2.628636_wp, 0.000000_wp, &
   & 2.508223_wp, 1.643435_wp, 2.637150_wp, 0.000000_wp, &
   & 2.480155_wp, 1.658706_wp, 2.645663_wp, 0.000000_wp, &
   & 3.195377_wp, 2.248538_wp, 2.414921_wp, 0.000000_wp, &
   & 3.141220_wp, 2.487234_wp, 2.219335_wp, 0.000000_wp, &
   & 3.176612_wp, 3.395385_wp, 2.375027_wp, 0.000000_wp, &
   & 3.145383_wp, 2.583611_wp, 2.471393_wp, 0.000000_wp, &
   & 1.815656_wp, 2.481062_wp, 3.185853_wp, 0.000000_wp, &
   & 2.117984_wp, 2.858570_wp, 3.470484_wp, 0.000000_wp, &
   & 2.712412_wp, 3.378860_wp, 3.641249_wp, 0.000000_wp, &
   & 2.805724_wp, 2.825702_wp, 3.720644_wp, 0.000000_wp, &
   & 2.619513_wp, 2.696078_wp, 0.000000_wp, 0.000000_wp, &
   & 3.053831_wp, 2.616838_wp, 3.321796_wp, 0.000000_wp, &
   & 3.021350_wp, 2.592502_wp, 4.246744_wp, 0.000000_wp, &
   & 3.164052_wp, 2.632387_wp, 3.046255_wp, 0.000000_wp, &
   & 2.961334_wp, 2.713884_wp, 2.310225_wp, 0.000000_wp, &
   & 2.982405_wp, 2.959607_wp, 2.437783_wp, 0.000000_wp, &
   & 3.079362_wp, 2.685897_wp, 2.103113_wp, 0.000000_wp], & ! 86
      & shape(zeta))

   integer :: isp, izp, ish, stat
   integer, allocatable :: nshell(:)
   type(cgto_type), allocatable :: cgto(:, :)

   nshell = nsh(mol%num)
   allocate(cgto(maxval(nshell), mol%nid))
   do isp = 1, mol%nid
      izp = mol%num(isp)
      do ish = 1, nshell(isp)
         call slater_to_gauss(ng, pqn(ish, izp), lsh(ish, izp), zeta(ish, izp), &
            & cgto(ish, isp), .true., stat)
      end do
   end do

   call new_basis(bas, mol, nshell, cgto, 1.0_wp)

end subroutine make_basis


subroutine test_overlap_mol(error, mol, ref)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   type(structure_type), intent(in) :: mol
   real(wp), intent(in) :: ref(:, :)

   type(basis_type) :: bas
   real(wp), allocatable :: lattr(:, :), overlap(:, :)
   real(wp) :: cutoff
   integer :: ii, jj

   call make_basis(bas, mol, 6)
   call check(error, bas%nao, size(ref, 1))
   if (allocated(error)) return

   cutoff = get_cutoff(bas)
   call get_lattice_points(mol%periodic, mol%lattice, cutoff, lattr)

   allocate(overlap(bas%nao, bas%nao))
   call get_overlap(mol, lattr, cutoff, bas, overlap)

   !where(abs(overlap) < thr) overlap = 0.0_wp
   !print '(*(6x,"&", 3(es20.14e1, "_wp":, ","), "&", /))', overlap

   do ii = 1, size(overlap, 2)
      do jj = 1, size(overlap, 1)
         call check(error, overlap(jj, ii), ref(jj, ii), thr=thr)
         if (allocated(error)) return
      end do
   end do


end subroutine test_overlap_mol

subroutine test_overlap_diat_mol(error, mol, ref)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   type(structure_type), intent(in) :: mol
   real(wp), intent(in) :: ref(:, :)

   type(basis_type) :: bas
   real(wp), allocatable :: lattr(:, :), overlap(:, :), overlap_scaled(:, :)
   real(wp) :: cutoff
   integer :: ii, jj
   real(wp) :: scalfac(3,86)

   scalfac = 1.0_wp

   call make_basis(bas, mol, 6)
   call check(error, bas%nao, size(ref, 1))
   if (allocated(error)) return

   cutoff = get_cutoff(bas)
   call get_lattice_points(mol%periodic, mol%lattice, cutoff, lattr)

   allocate(overlap(bas%nao, bas%nao), overlap_scaled(bas%nao, bas%nao))
   call get_overlap(mol, lattr, cutoff, bas, scalfac, overlap, overlap_scaled)

   do ii = 1, size(overlap_scaled, 2)
      do jj = 1, size(overlap_scaled, 1)
         call check(error, overlap_scaled(jj, ii), ref(jj, ii), thr=thr)
         if (allocated(error)) return
      end do
   end do


end subroutine test_overlap_diat_mol

subroutine test_overlap_alh3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 12
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869333E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.02664545809937E-1_wp, 4.02664545809937E-1_wp, 4.02664545809939E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.32775379754938E-1_wp,-4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.49862982000156E-1_wp, 4.99725964000314E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.26789082148469E-1_wp,-2.26789082148469E-1_wp,-2.26789082148469E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      &-1.96405106441530E-1_wp,-1.96405106441530E-1_wp, 3.92810212883060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      &-3.40183623222704E-1_wp, 3.40183623222704E-1_wp, 0.00000000000000E+0_wp,&
      & 4.02664545809937E-1_wp, 4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-1.96405106441530E-1_wp,-3.40183623222704E-1_wp,&
      & 9.99999999881495E-1_wp, 3.54600353330803E-2_wp, 3.54600353330805E-2_wp,&
      & 4.02664545809937E-1_wp,-4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-1.96405106441530E-1_wp, 3.40183623222704E-1_wp,&
      & 3.54600353330803E-2_wp, 9.99999999881495E-1_wp, 3.54600353330805E-2_wp,&
      & 4.02664545809939E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.99725964000314E-1_wp,-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 3.92810212883060E-1_wp, 0.00000000000000E+0_wp,&
      & 3.54600353330805E-2_wp, 3.54600353330805E-2_wp, 9.99999999881495E-1_wp],&
      & shape(overlap))
   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "AlH3")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_alh3

subroutine test_overlap_diat_alh3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 12
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869333E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.02664545809937E-1_wp, 4.02664545809937E-1_wp, 4.02664545809939E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.32775379754938E-1_wp,-4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.49862982000156E-1_wp, 4.99725964000314E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.26789082148469E-1_wp,-2.26789082148469E-1_wp,-2.26789082148469E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      &-1.96405106441530E-1_wp,-1.96405106441530E-1_wp, 3.92810212883060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      &-3.40183623222704E-1_wp, 3.40183623222704E-1_wp, 0.00000000000000E+0_wp,&
      & 4.02664545809937E-1_wp, 4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-1.96405106441530E-1_wp,-3.40183623222704E-1_wp,&
      & 9.99999999881495E-1_wp, 3.54600353330803E-2_wp, 3.54600353330805E-2_wp,&
      & 4.02664545809937E-1_wp,-4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-1.96405106441530E-1_wp, 3.40183623222704E-1_wp,&
      & 3.54600353330803E-2_wp, 9.99999999881495E-1_wp, 3.54600353330805E-2_wp,&
      & 4.02664545809939E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.99725964000314E-1_wp,-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 3.92810212883060E-1_wp, 0.00000000000000E+0_wp,&
      & 3.54600353330805E-2_wp, 3.54600353330805E-2_wp, 9.99999999881495E-1_wp],&
      & shape(overlap))
   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "AlH3")
   call test_overlap_diat_mol(error, mol, overlap)

end subroutine test_overlap_diat_alh3

subroutine test_overlap_bh3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 7
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 4.80899928496809E-1_wp, 4.80899928496809E-1_wp,&
      & 4.80899928496810E-1_wp, 0.00000000000000E+0_wp, 9.99999999925689E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 4.26420603078617E-1_wp,&
      &-4.26420603078617E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999925689E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp,-2.46194049975443E-1_wp,-2.46194049975443E-1_wp,&
      & 4.92388099950885E-1_wp, 4.80899928496809E-1_wp, 4.26420603078617E-1_wp,&
      & 0.00000000000000E+0_wp,-2.46194049975443E-1_wp, 9.99999999881495E-1_wp,&
      & 1.10583333710332E-1_wp, 1.10583333710331E-1_wp, 4.80899928496809E-1_wp,&
      &-4.26420603078617E-1_wp, 0.00000000000000E+0_wp,-2.46194049975443E-1_wp,&
      & 1.10583333710332E-1_wp, 9.99999999881495E-1_wp, 1.10583333710331E-1_wp,&
      & 4.80899928496810E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.92388099950885E-1_wp, 1.10583333710331E-1_wp, 1.10583333710331E-1_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "BH3")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_bh3

subroutine test_overlap_beh2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 6
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 4.75332491800271E-1_wp, 4.75332491800271E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999925689E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999925689E-1_wp,&
      & 0.00000000000000E+0_wp,-5.55623013601629E-1_wp, 5.55623013601629E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.75332491800271E-1_wp, 0.00000000000000E+0_wp,-5.55623013601629E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999881495E-1_wp, 4.00645037406879E-2_wp,&
      & 4.75332491800271E-1_wp, 0.00000000000000E+0_wp, 5.55623013601629E-1_wp,&
      & 0.00000000000000E+0_wp, 4.00645037406879E-2_wp, 9.99999999881495E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "BeH2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_beh2

subroutine test_overlap_ch4(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 8
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 4.22144465267144E-1_wp, 4.22144465267144E-1_wp,&
      & 4.22144465267144E-1_wp, 4.22144465267144E-1_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 2.57682345348632E-1_wp,-2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      & 2.57682345348632E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 2.57682345348632E-1_wp,&
      & 2.57682345348632E-1_wp,-2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp,-2.57682345348632E-1_wp, 2.57682345348632E-1_wp,&
      &-2.57682345348632E-1_wp, 2.57682345348632E-1_wp, 4.22144465267144E-1_wp,&
      & 2.57682345348632E-1_wp, 2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      & 9.99999999881495E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 1.71953274424808E-1_wp, 4.22144465267144E-1_wp,-2.57682345348632E-1_wp,&
      & 2.57682345348632E-1_wp, 2.57682345348632E-1_wp, 1.71953274424808E-1_wp,&
      & 9.99999999881495E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 4.22144465267144E-1_wp,-2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      &-2.57682345348632E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 9.99999999881495E-1_wp, 1.71953274424808E-1_wp, 4.22144465267144E-1_wp,&
      & 2.57682345348632E-1_wp,-2.57682345348632E-1_wp, 2.57682345348632E-1_wp,&
      & 1.71953274424808E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "CH4")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_ch4

subroutine test_overlap_cl2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 18
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.17210205959034E-2_wp, 0.00000000000000E+0_wp,-1.66880110378166E-1_wp,&
      & 0.00000000000000E+0_wp, 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-7.28795473739356E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.66880110378166E-1_wp, 0.00000000000000E+0_wp,-2.43857348208300E-1_wp,&
      & 0.00000000000000E+0_wp, 1.54878516243462E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,-7.28795473739356E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,-1.54878516243462E-1_wp,&
      & 0.00000000000000E+0_wp, 1.20587356016693E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.28795473739356E-2_wp, 0.00000000000000E+0_wp,-8.83217466681701E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830205E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-8.83217466681701E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.65407586749691E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.0000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.65407586749691E-2_wp,&
      & 9.17210205959034E-2_wp, 0.00000000000000E+0_wp, 1.66880110378166E-1_wp,&
      & 0.00000000000000E+0_wp, 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.28795473739356E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-1.66880110378166E-1_wp, 0.00000000000000E+0_wp,-2.43857348208300E-1_wp,&
      & 0.00000000000000E+0_wp,-1.54878516243462E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 6.66413853324784E-2_wp, 0.00000000000000E+0_wp, 7.28795473739356E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp, 1.54878516243462E-1_wp,&
      & 0.00000000000000E+0_wp, 1.20587356016693E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-7.28795473739356E-2_wp, 0.00000000000000E+0_wp,-8.83217466681701E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-8.83217466681701E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830205E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.65407586749691E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.65407586749691E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "Cl2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_cl2

subroutine test_overlap_diat_cl2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 18
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.17210205959034E-2_wp, 0.00000000000000E+0_wp,-1.66880110378166E-1_wp,&
      & 0.00000000000000E+0_wp, 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-7.28795473739356E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.66880110378166E-1_wp, 0.00000000000000E+0_wp,-2.43857348208300E-1_wp,&
      & 0.00000000000000E+0_wp, 1.54878516243462E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,-7.28795473739356E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,-1.54878516243462E-1_wp,&
      & 0.00000000000000E+0_wp, 1.20587356016693E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.28795473739356E-2_wp, 0.00000000000000E+0_wp,-8.83217466681701E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830205E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-8.83217466681701E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.65407586749691E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.0000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.65407586749691E-2_wp,&
      & 9.17210205959034E-2_wp, 0.00000000000000E+0_wp, 1.66880110378166E-1_wp,&
      & 0.00000000000000E+0_wp, 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.28795473739356E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-1.66880110378166E-1_wp, 0.00000000000000E+0_wp,-2.43857348208300E-1_wp,&
      & 0.00000000000000E+0_wp,-1.54878516243462E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 6.66413853324784E-2_wp, 0.00000000000000E+0_wp, 7.28795473739356E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp, 1.54878516243462E-1_wp,&
      & 0.00000000000000E+0_wp, 1.20587356016693E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-7.28795473739356E-2_wp, 0.00000000000000E+0_wp,-8.83217466681701E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-8.83217466681701E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830205E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.65407586749691E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.65407586749691E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "Cl2")
   call test_overlap_diat_mol(error, mol, overlap)

end subroutine test_overlap_diat_cl2

subroutine test_overlap_f2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 8
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.47958427103274E-1_wp, 0.00000000000000E+0_wp,&
      &-2.00620208590218E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.94087596423658E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 2.00620208590218E-1_wp,&
      & 0.00000000000000E+0_wp,-2.36369347922990E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.94087596423658E-2_wp, 1.47958427103274E-1_wp,&
      & 0.00000000000000E+0_wp, 2.00620208590218E-1_wp, 0.00000000000000E+0_wp,&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 7.94087596423658E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.00620208590218E-1_wp, 0.00000000000000E+0_wp,-2.36369347922990E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 7.94087596423658E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "F2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_f2

subroutine test_overlap_h2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 2
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999881495E-1_wp, 6.61346655776026E-1_wp, 6.61346655776026E-1_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "H2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_h2

subroutine test_overlap_lih(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 5
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 3.99089038384911E-1_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 4.65790780903622E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 3.99089038384911E-1_wp,&
      & 0.00000000000000E+0_wp, 4.65790780903622E-1_wp, 0.00000000000000E+0_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))


   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "LiH")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_lih

subroutine test_overlap_diat_cecl3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 43
   real(wp), parameter :: overlap(nao, nao) = reshape([&
   & +1.0000000001769E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +7.2527690736627E-02_wp, -3.1311924051566E-02_wp, &
   & +3.1317769818407E-02_wp, -1.1642837396403E-01_wp, -2.8692558611029E-02_wp, &
   & -2.8821884763781E-02_wp, -7.7512777686417E-03_wp, +4.9699863286590E-02_wp, &
   & +2.8816504878201E-02_wp, +7.2531169754944E-02_wp, +1.1647778352962E-01_wp, &
   & +3.1242823390743E-02_wp, +3.1221886607143E-02_wp, -2.8726162497391E-02_wp, &
   & +7.7101693674211E-03_wp, +2.8763906866208E-02_wp, -4.9765510063313E-02_wp, &
   & +2.8744631281347E-02_wp, +7.2541790306090E-02_wp, -3.1238229544784E-02_wp, &
   & -1.1649651755747E-01_wp, +3.1214703291230E-02_wp, +5.7475514003498E-02_wp, &
   & -2.8738960474736E-02_wp, +2.8760620782210E-02_wp, -5.8059663767308E-06_wp, &
   & -7.7062753720979E-03_wp, +0.0000000000000E+00_wp, +1.0000000000271E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +2.7755575615629E-17_wp, +0.0000000000000E+00_wp, &
   & +5.5511151231258E-17_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.7081055199720E-02_wp, &
   & +1.0598752272757E-01_wp, +1.8650030196888E-02_wp, -6.9334205557879E-02_wp, &
   & +1.1307294432644E-03_wp, -6.8926432568766E-03_wp, +1.1992216658821E-02_wp, &
   & +2.5728852338766E-02_wp, -4.4582813332712E-02_wp, -3.6112408417079E-01_wp, &
   & -1.3337060952446E-01_wp, -6.9205269033884E-02_wp, -6.9158892439694E-02_wp, &
   & -4.1779299344457E-03_wp, -6.8583411715455E-03_wp, -1.1773659788908E-02_wp, &
   & -7.2271918612763E-03_wp, -1.1765769894832E-02_wp, +9.6842287199670E-02_wp, &
   & +1.0609152552078E-01_wp, -6.9190091296643E-02_wp, +1.8539165082359E-02_wp, &
   & +2.1680093834721E-02_wp, -6.8539755877766E-03_wp, -4.4639229504342E-02_wp, &
   & +1.3807765718289E-02_wp, +1.1960875168992E-02_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +1.0000000000271E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -5.5511151231258E-17_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -9.7099179707573E-02_wp, +1.8650030196888E-02_wp, +1.0598055965799E-01_wp, &
   & +6.9347149878998E-02_wp, +2.2850870433709E-02_wp, -4.4580239934487E-02_wp, &
   & -1.1989286112168E-02_wp, -1.1887750752491E-02_wp, -6.8926432568766E-03_wp, &
   & -9.6864274387767E-02_wp, -6.9205269033884E-02_wp, +1.0607376340248E-01_wp, &
   & -1.8550482305867E-02_wp, +2.2803095202478E-02_wp, +1.1963510029443E-02_wp, &
   & +4.4631612080258E-02_wp, +1.1873829350932E-02_wp, -6.8583411715455E-03_wp, &
   & +3.6115328478804E-01_wp, -6.9190091296643E-02_wp, -1.3338547475478E-01_wp, &
   & +6.9137982593462E-02_wp, -8.3463679766073E-03_wp, -1.1761734282202E-02_wp, &
   & +1.1770599000228E-02_wp, -5.1638372478798E-06_wp, -6.8539755877766E-03_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +1.0000000000271E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +5.5511151231258E-17_wp, +0.0000000000000E+00_wp, &
   & -2.7755575615629E-17_wp, +3.6098035307577E-01_wp, -6.9334205557879E-02_wp, &
   & +6.9347149878998E-02_wp, -1.3317406552720E-01_wp, +4.2044363117297E-03_wp, &
   & -1.1783284846162E-02_wp, -6.8926432568766E-03_wp, -7.2797239108791E-03_wp, &
   & +1.1781085381250E-02_wp, -9.6799362637441E-02_wp, -6.9158892439694E-02_wp, &
   & -1.8550482305867E-02_wp, +1.0609863424410E-01_wp, -1.1198947190876E-03_wp, &
   & +1.1973998912957E-02_wp, -6.8583411715455E-03_wp, +2.5668994476862E-02_wp, &
   & +4.4640807135904E-02_wp, -9.6769352970151E-02_wp, +1.8539165082359E-02_wp, &
   & +6.9137982593462E-02_wp, +1.0611946061625E-01_wp, -2.1663766040475E-02_wp, &
   & -4.4649557178838E-02_wp, -6.8539755877766E-03_wp, +1.3800134014195E-02_wp, &
   & -1.1972659316082E-02_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999977861E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +4.8074067159589E-17_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -4.3596943056074E-02_wp, &
   & +1.4790196485634E-02_wp, -4.0293433565377E-02_wp, +5.4994976501443E-02_wp, &
   & +1.2427542636657E-02_wp, +4.1155781040514E-02_wp, +1.1068321632848E-02_wp, &
   & -2.0486090507708E-02_wp, -1.1878051326751E-02_wp, -4.3648381496804E-02_wp, &
   & -5.5116315883246E-02_wp, -4.0223618270658E-02_wp, -1.4773936389961E-02_wp, &
   & +1.2521098644510E-02_wp, -1.1019258633235E-02_wp, -4.1108945077173E-02_wp, &
   & +2.0574445695289E-02_wp, -1.1883829876892E-02_wp, +8.7334312644183E-02_wp, &
   & -5.5013472109314E-02_wp, -1.1029925038494E-01_wp, +5.4972040155180E-02_wp, &
   & +4.8216046970693E-02_wp, -5.2973934099804E-02_wp, +5.3013860098579E-02_wp, &
   & -1.6599793687753E-05_wp, -2.2032952479852E-02_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999977861E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -4.3793447836063E-02_wp, +2.3393738073111E-02_wp, +3.1335702053196E-02_wp, &
   & +7.2263161172877E-02_wp, +4.1155781040514E-02_wp, -2.6150622574668E-02_wp, &
   & -8.4171140107690E-03_wp, -3.7482620926192E-02_wp, -2.6987269641242E-02_wp, &
   & +1.1715327934413E-02_wp, +2.3278725295685E-02_wp, -8.4337681639729E-03_wp, &
   & -8.4477951516736E-03_wp, -1.1019258633235E-02_wp, +2.9078826501523E-03_wp, &
   & -8.4374693288628E-03_wp, -1.9088941687601E-02_wp, -8.4544157891327E-03_wp, &
   & -4.3668985004930E-02_wp, +2.3268206571198E-02_wp, +7.2098953192111E-02_wp, &
   & +3.1517986634473E-02_wp, -5.2973934099804E-02_wp, -2.6370131759252E-02_wp, &
   & -2.6857903704922E-02_wp, +1.6861155128907E-02_wp, -8.4600738354531E-03_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999977861E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, -1.1777688426901E-02_wp, -8.4312595356809E-03_wp, &
   & +8.4273368199342E-03_wp, +2.3393738073111E-02_wp, +1.1068321632848E-02_wp, &
   & -8.4171140107690E-03_wp, +2.8833922977824E-03_wp, -1.9171747086285E-02_wp, &
   & +8.4218522153872E-03_wp, +4.3705732721827E-02_wp, +7.2157005558729E-02_wp, &
   & -3.1463397292509E-02_wp, +2.3278725295685E-02_wp, -4.1108945077173E-02_wp, &
   & -8.4374693288628E-03_wp, -2.6307657509996E-02_wp, -3.7477015603492E-02_wp, &
   & +2.6868453736935E-02_wp, +4.3701897943556E-02_wp, +3.1482925747474E-02_wp, &
   & -7.2153293553380E-02_wp, +2.3268206571198E-02_wp, +5.3013860098579E-02_wp, &
   & -2.6857903704922E-02_wp, -2.6329661862102E-02_wp, +1.6861185214554E-02_wp, &
   & +8.4410338787384E-03_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +4.8074067159589E-17_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999977861E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +7.5516517678812E-02_wp, &
   & -5.5059637602732E-02_wp, +4.0347210354279E-02_wp, -9.5262827615026E-02_wp, &
   & -2.0486090507708E-02_wp, -3.7482620926192E-02_wp, -1.9171747086285E-02_wp, &
   & +3.6092386075658E-02_wp, +5.4374694282967E-02_wp, -7.5616921293395E-02_wp, &
   & -9.5495469486322E-02_wp, -4.0302400355202E-02_wp, -5.4953210623244E-02_wp, &
   & +2.0574445695289E-02_wp, -1.9088941687601E-02_wp, -3.7477015603492E-02_wp, &
   & +3.6312544493722E-02_wp, -5.4309124159528E-02_wp, -8.8221930945312E-06_wp, &
   & -1.4681371438029E-02_wp, +1.7530443499082E-05_wp, -1.4679708950635E-02_wp, &
   & -1.6599793687761E-05_wp, +1.6861155128907E-02_wp, +1.6861185214554E-02_wp, &
   & +6.5698399264750E-04_wp, +1.6985086959525E-06_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999977861E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +4.3785273362380E-02_wp, +3.1344436206665E-02_wp, +2.3393738073111E-02_wp, &
   & -7.2249672549842E-02_wp, -1.1878051326751E-02_wp, -2.6987269641242E-02_wp, &
   & +8.4218522153872E-03_wp, +5.4374694282967E-02_wp, -2.6160698388718E-02_wp, &
   & +4.3676444156685E-02_wp, +7.2108650914474E-02_wp, +2.3278725295685E-02_wp, &
   & -3.1494607343033E-02_wp, -1.1883829876892E-02_wp, -8.4544157891327E-03_wp, &
   & +2.6868453736935E-02_wp, -5.4309124159528E-02_wp, -2.6343680350078E-02_wp, &
   & -1.1709721510764E-02_wp, -8.4357044017429E-03_wp, +2.3268206571198E-02_wp, &
   & +8.4514638026962E-03_wp, -2.2032952479852E-02_wp, -8.4600738354531E-03_wp, &
   & +8.4410338787385E-03_wp, +1.6985086959519E-06_wp, +2.9114180444325E-03_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999995455E-01_wp, +0.0000000000000E+00_wp, +1.1102230246252E-16_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +2.6526280473723E-02_wp, +1.4250727716061E-02_wp, &
   & +1.6452084558743E-02_wp, -4.3362988500125E-02_wp, -1.0619722404731E-02_wp, &
   & +4.3065157967244E-03_wp, -6.1885071391703E-03_wp, -2.0932613685597E-02_wp, &
   & +3.7545440298355E-02_wp, +2.6459983595433E-02_wp, +3.0292579774280E-02_wp, &
   & +1.6370997304509E-02_wp, +3.4116001467871E-02_wp, +3.7908157384580E-02_wp, &
   & +1.5873123660660E-02_wp, -6.2041436166685E-03_wp, +1.4198662349598E-02_wp, &
   & -9.4010973066397E-03_wp, +1.2981125767590E-03_wp, -8.0651671840295E-04_wp, &
   & -2.9943617039990E-03_wp, -3.9582287881061E-03_wp, -1.8191287359940E-03_wp, &
   & +1.3604302953205E-03_wp, +3.7579715801848E-03_wp, +5.4349699818026E-03_wp, &
   & +1.4568020488924E-03_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999995455E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -1.1939645729075E-02_wp, &
   & -7.1325755706931E-03_wp, +7.1284799634805E-03_wp, +2.3620487381987E-02_wp, &
   & +7.0462232406280E-03_wp, +2.1874321901723E-03_wp, +1.2437964827838E-02_wp, &
   & -7.0408037309320E-03_wp, -2.1544441535770E-02_wp, -1.1881044027130E-02_wp, &
   & -2.3516486665670E-02_wp, +7.1467985846350E-03_wp, +7.1614465143776E-03_wp, &
   & +7.0998130741613E-03_wp, +7.0804247943218E-03_wp, +1.2390998028010E-02_wp, &
   & -2.2122096057885E-03_wp, +2.1466297042406E-02_wp, -1.1875975300214E-02_wp, &
   & -7.1499491235581E-03_wp, +2.3507385642345E-02_wp, +7.1664066284969E-03_wp, &
   & +2.2156528844113E-03_wp, +7.0860215765566E-03_wp, -2.4778890068752E-02_wp, &
   & -7.1078059000031E-03_wp, +2.5030729187188E-06_wp, +0.0000000000000E+00_wp, &
   & +2.7755575615629E-17_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +1.1102230246252E-16_wp, &
   & +0.0000000000000E+00_wp, +9.9999999995455E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -5.4946677749678E-03_wp, -4.5184586218376E-03_wp, -8.3529036156068E-03_wp, &
   & +8.0733918424327E-03_wp, +4.1576953283294E-03_wp, -2.9902373244963E-03_wp, &
   & +9.3580012300314E-04_wp, +1.1036676205817E-02_wp, -5.5535931393775E-03_wp, &
   & +2.0485740745273E-02_wp, +2.3444590819335E-02_wp, +3.1025276160240E-02_wp, &
   & +8.0816201653622E-03_wp, +6.5856084294693E-03_wp, +3.5069948504052E-02_wp, &
   & -3.5753546579448E-03_wp, +1.0995416506821E-02_wp, -7.9681358032705E-03_wp, &
   & +2.7024899774620E-02_wp, +1.5040286097405E-02_wp, -4.3988891340934E-02_wp, &
   & +1.7932469062252E-02_wp, +4.9502872598173E-03_wp, -1.1466504086879E-02_wp, &
   & +3.5840896450524E-02_wp, -2.2935587518175E-02_wp, +1.3454422324185E-02_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999995455E-01_wp, +0.0000000000000E+00_wp, +5.5511151231258E-17_wp, &
   & +0.0000000000000E+00_wp, +1.7608595912580E-02_wp, -7.8909469764037E-03_wp, &
   & -8.4939172432656E-03_wp, -2.9341222340284E-02_wp, +9.7893180830858E-03_wp, &
   & +1.5713182721376E-03_wp, -2.0601611867995E-02_wp, +5.8426952972824E-03_wp, &
   & +1.6883649577029E-02_wp, +1.7576637972573E-02_wp, +2.9305447783970E-02_wp, &
   & -8.5633962341228E-03_wp, +7.8553294882197E-03_wp, +9.7516739323045E-03_wp, &
   & -5.9349258719369E-03_wp, -2.0590330181413E-02_wp, -1.5908577325246E-03_wp, &
   & -1.6883049306225E-02_wp, +3.3478892754692E-02_wp, -3.1944682425620E-02_wp, &
   & -3.8331555743657E-02_wp, +3.1920624125601E-02_wp, -1.7953625020407E-02_wp, &
   & +3.4032638251686E-02_wp, +1.4234076450863E-02_wp, -3.4007007462481E-02_wp, &
   & -1.3526397406737E-05_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +2.7755575615629E-17_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999995455E-01_wp, &
   & +0.0000000000000E+00_wp, -1.6653345369377E-16_wp, -2.0431041971695E-02_wp, &
   & +8.0733918424327E-03_wp, -3.1058934105799E-02_wp, +2.3329920112775E-02_wp, &
   & -6.5560495143752E-03_wp, +1.1036676205817E-02_wp, +3.4796228586006E-03_wp, &
   & +3.5079702169269E-02_wp, -7.8851687828077E-03_wp, +5.4912057495463E-03_wp, &
   & +8.0816201653622E-03_wp, +8.3163297315321E-03_wp, -4.5387877622646E-03_wp, &
   & -4.1810970891481E-03_wp, +1.0995416506821E-02_wp, -9.5837432966168E-04_wp, &
   & -3.0027270828935E-03_wp, -5.5704921581408E-03_wp, -2.7004546679915E-02_wp, &
   & +1.7932469062252E-02_wp, +4.3955762260755E-02_wp, +1.5067307014100E-02_wp, &
   & -4.9668267830807E-03_wp, -2.2935587518175E-02_wp, -3.5813903819067E-02_wp, &
   & -1.1501063778437E-02_wp, +1.3457088366666E-02_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999995455E-01_wp, +0.0000000000000E+00_wp, &
   & -2.0592322453173E-02_wp, +1.6678724992055E-02_wp, +1.2294498625827E-02_wp, &
   & +3.2944407068926E-02_wp, -2.1544441535770E-02_wp, -4.9976365244802E-03_wp, &
   & +2.1451774048233E-02_wp, -9.7846221677690E-03_wp, -1.7619808566087E-02_wp, &
   & +2.0569622560387E-02_wp, +3.2939143462148E-02_wp, -1.2373234967008E-02_wp, &
   & +1.6606771295855E-02_wp, +2.1466297042406E-02_wp, -9.8850860212807E-03_wp, &
   & -2.1452504678938E-02_wp, -5.0237091689407E-03_wp, -1.7665770147214E-02_wp, &
   & -8.9474499618165E-06_wp, -1.4501064908625E-02_wp, +1.7710642827303E-05_wp, &
   & -1.4501204125470E-02_wp, +2.5030729187185E-06_wp, +1.8004216541053E-02_wp, &
   & -1.8668603916296E-05_wp, +1.8007088403204E-02_wp, -1.1066808990472E-03_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, -1.1102230246252E-16_wp, +0.0000000000000E+00_wp, &
   & +9.9999999995455E-01_wp, +2.6380001479232E-02_wp, -3.4158339432813E-02_wp, &
   & +1.6361359649574E-02_wp, -3.0125997884322E-02_wp, +3.7919513721465E-02_wp, &
   & -1.4249312018309E-02_wp, -6.1543806583537E-03_wp, -1.5833214838513E-02_wp, &
   & +9.2287903009066E-03_wp, +2.6474940844480E-02_wp, +4.3311981790552E-02_wp, &
   & +1.6380251470633E-02_wp, -1.4371601459718E-02_wp, -1.0776928708690E-02_wp, &
   & +2.0855653931009E-02_wp, -6.2076506831360E-03_wp, -4.3478903642740E-03_wp, &
   & -3.7539365579622E-02_wp, +1.3010499205939E-03_wp, +3.9558072278322E-03_wp, &
   & -3.0011372872945E-03_wp, +8.0055422357969E-04_wp, -1.8210478240649E-03_wp, &
   & -5.4308824808427E-03_wp, +3.7664750450233E-03_wp, -1.3522438795740E-03_wp, &
   & -1.4562525102727E-03_wp, +7.2527690736627E-02_wp, +9.7081055199720E-02_wp, &
   & -9.7099179707573E-02_wp, +3.6098035307577E-01_wp, -4.3596943056074E-02_wp, &
   & -4.3793447836063E-02_wp, -1.1777688426901E-02_wp, +7.5516517678812E-02_wp, &
   & +4.3785273362380E-02_wp, +2.6526280473723E-02_wp, -1.1939645729075E-02_wp, &
   & -5.4946677749678E-03_wp, +1.7608595912580E-02_wp, -2.0431041971695E-02_wp, &
   & -2.0592322453173E-02_wp, +2.6380001479232E-02_wp, +9.9999999986933E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +1.1402236291213E-04_wp, &
   & +3.1749759091467E-04_wp, -1.6417919744594E-07_wp, +3.1720664241995E-04_wp, &
   & -9.2951035182869E-05_wp, -8.3251580263389E-08_wp, -8.3327940335095E-08_wp, &
   & -1.4760110148966E-07_wp, +1.6099589098168E-04_wp, +1.1404426518944E-04_wp, &
   & +1.7118096128378E-07_wp, -3.1757417749217E-04_wp, +3.1724130066524E-04_wp, &
   & +4.6630807922303E-05_wp, -1.6102719029378E-04_wp, -8.6889031060939E-08_wp, &
   & +8.0429178500790E-05_wp, +8.6797955189522E-08_wp, -3.1311924051566E-02_wp, &
   & +1.0598752272757E-01_wp, +1.8650030196888E-02_wp, -6.9334205557879E-02_wp, &
   & +1.4790196485634E-02_wp, +2.3393738073111E-02_wp, -8.4312595356809E-03_wp, &
   & -5.5059637602732E-02_wp, +3.1344436206665E-02_wp, +1.4250727716061E-02_wp, &
   & -7.1325755706931E-03_wp, -4.5184586218376E-03_wp, -7.8909469764037E-03_wp, &
   & +8.0733918424327E-03_wp, +1.6678724992055E-02_wp, -3.4158339432813E-02_wp, &
   & +0.0000000000000E+00_wp, +9.9999999999806E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -3.1749759091467E-04_wp, -6.6022002305979E-04_wp, +3.9940959291168E-07_wp, &
   & -7.7168957997590E-04_wp, +2.4630367992221E-04_wp, +2.5257851949662E-07_wp, &
   & +2.2083351813289E-07_wp, -6.1390208475963E-05_wp, -4.2666708030283E-04_wp, &
   & -1.7118096128378E-07_wp, +1.1219727395084E-04_wp, +4.1646460064375E-07_wp, &
   & -4.1602806825348E-07_wp, -9.5511237798258E-08_wp, +2.6335006312020E-07_wp, &
   & -6.1853888097456E-05_wp, -1.6487794718374E-07_wp, +6.1789053713988E-05_wp, &
   & +3.1317769818407E-02_wp, +1.8650030196888E-02_wp, +1.0598055965799E-01_wp, &
   & +6.9347149878998E-02_wp, -4.0293433565377E-02_wp, +3.1335702053196E-02_wp, &
   & +8.4273368199342E-03_wp, +4.0347210354279E-02_wp, +2.3393738073111E-02_wp, &
   & +1.6452084558743E-02_wp, +7.1284799634805E-03_wp, -8.3529036156068E-03_wp, &
   & -8.4939172432656E-03_wp, -3.1058934105799E-02_wp, +1.2294498625827E-02_wp, &
   & +1.6361359649574E-02_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999999806E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +1.6417919744594E-07_wp, +3.9940959291168E-07_wp, &
   & +1.1217716002719E-04_wp, +3.9904358188306E-07_wp, -1.8274977839917E-07_wp, &
   & +6.1781220463466E-05_wp, +6.1837887476990E-05_wp, -2.3156409435677E-10_wp, &
   & +2.5257851949662E-07_wp, +3.1757417749217E-04_wp, +4.1646460064375E-07_wp, &
   & -6.6042582376117E-04_wp, +7.7181346919900E-04_wp, +7.0057711469212E-05_wp, &
   & -4.2677670010054E-04_wp, -2.3028541877598E-07_wp, +2.4402682285130E-04_wp, &
   & +2.6335006312020E-07_wp, -1.1642837396403E-01_wp, -6.9334205557879E-02_wp, &
   & +6.9347149878998E-02_wp, -1.3317406552720E-01_wp, +5.4994976501443E-02_wp, &
   & +7.2263161172877E-02_wp, +2.3393738073111E-02_wp, -9.5262827615026E-02_wp, &
   & -7.2249672549842E-02_wp, -4.3362988500125E-02_wp, +2.3620487381987E-02_wp, &
   & +8.0733918424327E-03_wp, -2.9341222340284E-02_wp, +2.3329920112775E-02_wp, &
   & +3.2944407068926E-02_wp, -3.0125997884322E-02_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999999806E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -3.1720664241995E-04_wp, &
   & -7.7168957997590E-04_wp, +3.9904358188306E-07_wp, -6.5880505238795E-04_wp, &
   & +2.4607797211538E-04_wp, +2.2037038994418E-07_wp, +2.5257851949662E-07_wp, &
   & +6.2228750438940E-05_wp, -4.2616280871542E-04_wp, -3.1724130066524E-04_wp, &
   & -4.1602806825348E-07_wp, +7.7181346919900E-04_wp, -6.5880696664070E-04_wp, &
   & -1.7700630420597E-04_wp, +4.2619975760515E-04_wp, +2.6335006312020E-07_wp, &
   & -1.8198184166980E-04_wp, -2.2973304939934E-07_wp, -2.8692558611029E-02_wp, &
   & +1.1307294432644E-03_wp, +2.2850870433709E-02_wp, +4.2044363117296E-03_wp, &
   & +1.2427542636657E-02_wp, +4.1155781040514E-02_wp, +1.1068321632848E-02_wp, &
   & -2.0486090507708E-02_wp, -1.1878051326751E-02_wp, -1.0619722404731E-02_wp, &
   & +7.0462232406280E-03_wp, +4.1576953283294E-03_wp, +9.7893180830858E-03_wp, &
   & -6.5560495143752E-03_wp, -2.1544441535770E-02_wp, +3.7919513721465E-02_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -9.2951035182869E-05_wp, -2.4630367992221E-04_wp, +1.8274977839917E-07_wp, &
   & -2.4607797211538E-04_wp, +8.6407089179559E-05_wp, +1.0413027116948E-07_wp, &
   & +1.0422578160842E-07_wp, +1.3141261428098E-07_wp, -1.4333829970694E-04_wp, &
   & +4.6630807922303E-05_wp, +9.5511237798258E-08_wp, -7.0057711469212E-05_wp, &
   & +1.7700630420597E-04_wp, -2.5794630113637E-05_wp, -7.1969516677254E-05_wp, &
   & -3.8834196626061E-08_wp, +6.4939862646865E-05_wp, +7.0082119363944E-08_wp, &
   & -2.8821884763781E-02_wp, -6.8926432568766E-03_wp, -4.4580239934487E-02_wp, &
   & -1.1783284846162E-02_wp, +4.1155781040514E-02_wp, -2.6150622574668E-02_wp, &
   & -8.4171140107690E-03_wp, -3.7482620926192E-02_wp, -2.6987269641242E-02_wp, &
   & +4.3065157967244E-03_wp, +2.1874321901723E-03_wp, -2.9902373244963E-03_wp, &
   & +1.5713182721376E-03_wp, +1.1036676205817E-02_wp, -4.9976365244802E-03_wp, &
   & -1.4249312018309E-02_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, -8.3251580263389E-08_wp, -2.5257851949662E-07_wp, &
   & -6.1781220463466E-05_wp, -2.2037038994418E-07_wp, +1.0413027116948E-07_wp, &
   & -2.9824363899185E-05_wp, -3.3505747497459E-05_wp, +1.7475460218587E-08_wp, &
   & -1.4569102046574E-07_wp, -1.6102719029378E-04_wp, -2.6335006312020E-07_wp, &
   & +4.2677670010054E-04_wp, -4.2619975760515E-04_wp, -7.1969516677254E-05_wp, &
   & +2.5196902574673E-04_wp, +1.5209261706388E-07_wp, -1.2399343458034E-04_wp, &
   & -1.5189530592425E-07_wp, -7.7512777686417E-03_wp, +1.1992216658821E-02_wp, &
   & -1.1989286112168E-02_wp, -6.8926432568766E-03_wp, +1.1068321632848E-02_wp, &
   & -8.4171140107690E-03_wp, +2.8833922977824E-03_wp, -1.9171747086285E-02_wp, &
   & +8.4218522153872E-03_wp, -6.1885071391703E-03_wp, +1.2437964827838E-02_wp, &
   & +9.3580012300314E-04_wp, -2.0601611867995E-02_wp, +3.4796228586006E-03_wp, &
   & +2.1451774048233E-02_wp, -6.1543806583537E-03_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -8.3327940335095E-08_wp, &
   & -2.2083351813289E-07_wp, -6.1837887476990E-05_wp, -2.5257851949662E-07_wp, &
   & +1.0422578160842E-07_wp, -3.3505747497459E-05_wp, -2.9885800066366E-05_wp, &
   & -1.7192277609346E-08_wp, -1.4585644937581E-07_wp, -8.6889031060939E-08_wp, &
   & +6.1853888097456E-05_wp, +2.3028541877598E-07_wp, -2.6335006312020E-07_wp, &
   & -3.8834196626061E-08_wp, +1.5209261706388E-07_wp, -2.9896698388673E-05_wp, &
   & -1.0307280732346E-07_wp, +3.3513086522452E-05_wp, +4.9699863286590E-02_wp, &
   & +2.5728852338766E-02_wp, -1.1887750752491E-02_wp, -7.2797239108791E-03_wp, &
   & -2.0486090507708E-02_wp, -3.7482620926192E-02_wp, -1.9171747086285E-02_wp, &
   & +3.6092386075658E-02_wp, +5.4374694282967E-02_wp, -2.0932613685597E-02_wp, &
   & -7.0408037309320E-03_wp, +1.1036676205817E-02_wp, +5.8426952972824E-03_wp, &
   & +3.5079702169269E-02_wp, -9.7846221677690E-03_wp, -1.5833214838513E-02_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, &
   & -1.4760110148966E-07_wp, +6.1390208475963E-05_wp, +2.3156409435677E-10_wp, &
   & -6.2228750438940E-05_wp, +1.3141261428099E-07_wp, +1.7475460218587E-08_wp, &
   & -1.7192277609346E-08_wp, -6.3360738357634E-05_wp, -2.8904960247923E-07_wp, &
   & +8.0429178500790E-05_wp, +1.6487794718374E-07_wp, -2.4402682285130E-04_wp, &
   & +1.8198184166980E-04_wp, +6.4939862646865E-05_wp, -1.2399343458034E-04_wp, &
   & -1.0307280732346E-07_wp, +4.8844238134989E-05_wp, +8.4900269928562E-08_wp, &
   & +2.8816504878201E-02_wp, -4.4582813332712E-02_wp, -6.8926432568766E-03_wp, &
   & +1.1781085381250E-02_wp, -1.1878051326751E-02_wp, -2.6987269641242E-02_wp, &
   & +8.4218522153872E-03_wp, +5.4374694282967E-02_wp, -2.6160698388718E-02_wp, &
   & +3.7545440298355E-02_wp, -2.1544441535770E-02_wp, -5.5535931393775E-03_wp, &
   & +1.6883649577029E-02_wp, -7.8851687828077E-03_wp, -1.7619808566087E-02_wp, &
   & +9.2287903009066E-03_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999983021E-01_wp, +1.6099589098168E-04_wp, +4.2666708030283E-04_wp, &
   & -2.5257851949662E-07_wp, +4.2616280871542E-04_wp, -1.4333829970694E-04_wp, &
   & -1.4569102046574E-07_wp, -1.4585644937581E-07_wp, -2.8904960247923E-07_wp, &
   & +2.5191983004583E-04_wp, +8.6797955189522E-08_wp, -6.1789053713988E-05_wp, &
   & -2.6335006312020E-07_wp, +2.2973304939934E-07_wp, +7.0082119363944E-08_wp, &
   & -1.5189530592425E-07_wp, +3.3513086522452E-05_wp, +8.4900269928562E-08_wp, &
   & -2.9826405628944E-05_wp, +7.2531169754944E-02_wp, -3.6112408417079E-01_wp, &
   & -9.6864274387767E-02_wp, -9.6799362637441E-02_wp, -4.3648381496804E-02_wp, &
   & +1.1715327934413E-02_wp, +4.3705732721827E-02_wp, -7.5616921293395E-02_wp, &
   & +4.3676444156686E-02_wp, +2.6459983595433E-02_wp, -1.1881044027130E-02_wp, &
   & +2.0485740745273E-02_wp, +1.7576637972573E-02_wp, +5.4912057495463E-03_wp, &
   & +2.0569622560387E-02_wp, +2.6474940844480E-02_wp, +1.1402236291213E-04_wp, &
   & -3.1749759091467E-04_wp, +1.6417919744594E-07_wp, -3.1720664241995E-04_wp, &
   & -9.2951035182869E-05_wp, -8.3251580263389E-08_wp, -8.3327940335095E-08_wp, &
   & -1.4760110148966E-07_wp, +1.6099589098168E-04_wp, +9.9999999986933E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +1.1409568034293E-04_wp, &
   & -3.1752651913565E-04_wp, -3.1755028514580E-04_wp, -2.5099953499080E-08_wp, &
   & +4.6516245550781E-05_wp, +1.2734757828898E-08_wp, +1.6110082935387E-04_wp, &
   & -8.0544385641901E-05_wp, +1.2733804737693E-08_wp, +1.1647778352962E-01_wp, &
   & -1.3337060952446E-01_wp, -6.9205269033884E-02_wp, -6.9158892439694E-02_wp, &
   & -5.5116315883246E-02_wp, +2.3278725295685E-02_wp, +7.2157005558729E-02_wp, &
   & -9.5495469486322E-02_wp, +7.2108650914474E-02_wp, +3.0292579774280E-02_wp, &
   & -2.3516486665670E-02_wp, +2.3444590819335E-02_wp, +2.9305447783970E-02_wp, &
   & +8.0816201653622E-03_wp, +3.2939143462148E-02_wp, +4.3311981790552E-02_wp, &
   & +3.1749759091467E-04_wp, -6.6022002305979E-04_wp, +3.9940959291168E-07_wp, &
   & -7.7168957997590E-04_wp, -2.4630367992221E-04_wp, -2.5257851949662E-07_wp, &
   & -2.2083351813289E-07_wp, +6.1390208475963E-05_wp, +4.2666708030283E-04_wp, &
   & +0.0000000000000E+00_wp, +9.9999999999806E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +3.1752651913565E-04_wp, -6.5980252646670E-04_wp, -7.7210506875701E-04_wp, &
   & -6.1029078633347E-08_wp, +1.7675478921166E-04_wp, +3.8614514369150E-08_wp, &
   & +4.2664028577479E-04_wp, -1.8238051699945E-04_wp, +3.3722694750107E-08_wp, &
   & +3.1242823390743E-02_wp, -6.9205269033884E-02_wp, +1.0607376340248E-01_wp, &
   & -1.8550482305867E-02_wp, -4.0223618270658E-02_wp, -8.4337681639729E-03_wp, &
   & -3.1463397292509E-02_wp, -4.0302400355202E-02_wp, +2.3278725295685E-02_wp, &
   & +1.6370997304509E-02_wp, +7.1467985846350E-03_wp, +3.1025276160240E-02_wp, &
   & -8.5633962341228E-03_wp, +8.3163297315321E-03_wp, -1.2373234967008E-02_wp, &
   & +1.6380251470633E-02_wp, -1.6417919744594E-07_wp, +3.9940959291168E-07_wp, &
   & +1.1217716002719E-04_wp, +3.9904358188306E-07_wp, +1.8274977839917E-07_wp, &
   & -6.1781220463466E-05_wp, -6.1837887476990E-05_wp, +2.3156409435677E-10_wp, &
   & -2.5257851949662E-07_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999999806E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +3.1755028514580E-04_wp, -7.7210506875701E-04_wp, &
   & -6.5991810213760E-04_wp, -6.1033646496549E-08_wp, +6.9637303501062E-05_wp, &
   & +3.3728474919912E-08_wp, +4.2668147721732E-04_wp, -2.4424611502933E-04_wp, &
   & +3.8614514369150E-08_wp, +3.1221886607143E-02_wp, -6.9158892439694E-02_wp, &
   & -1.8550482305867E-02_wp, +1.0609863424410E-01_wp, -1.4773936389961E-02_wp, &
   & -8.4477951516736E-03_wp, +2.3278725295685E-02_wp, -5.4953210623244E-02_wp, &
   & -3.1494607343033E-02_wp, +3.4116001467871E-02_wp, +7.1614465143776E-03_wp, &
   & +8.0816201653622E-03_wp, +7.8553294882197E-03_wp, -4.5387877622646E-03_wp, &
   & +1.6606771295855E-02_wp, -1.4371601459718E-02_wp, +3.1720664241995E-04_wp, &
   & -7.7168957997590E-04_wp, +3.9904358188306E-07_wp, -6.5880505238795E-04_wp, &
   & -2.4607797211538E-04_wp, -2.2037038994418E-07_wp, -2.5257851949662E-07_wp, &
   & -6.2228750438940E-05_wp, +4.2616280871542E-04_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999999806E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +2.5099953499080E-08_wp, &
   & -6.1029078633347E-08_wp, -6.1033646496549E-08_wp, +1.1224475179317E-04_wp, &
   & +1.3972177826372E-08_wp, -6.1851944283869E-05_wp, +3.8614514369150E-08_wp, &
   & -2.4194741717859E-08_wp, -6.1847315177850E-05_wp, -2.8726162497391E-02_wp, &
   & -4.1779299344457E-03_wp, +2.2803095202478E-02_wp, -1.1198947190876E-03_wp, &
   & +1.2521098644510E-02_wp, -1.1019258633235E-02_wp, -4.1108945077173E-02_wp, &
   & +2.0574445695289E-02_wp, -1.1883829876892E-02_wp, +3.7908157384580E-02_wp, &
   & +7.0998130741613E-03_wp, +6.5856084294693E-03_wp, +9.7516739323045E-03_wp, &
   & -4.1810970891481E-03_wp, +2.1466297042406E-02_wp, -1.0776928708690E-02_wp, &
   & -9.2951035182869E-05_wp, +2.4630367992221E-04_wp, -1.8274977839917E-07_wp, &
   & +2.4607797211538E-04_wp, +8.6407089179559E-05_wp, +1.0413027116948E-07_wp, &
   & +1.0422578160842E-07_wp, +1.3141261428098E-07_wp, -1.4333829970694E-04_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +4.6516245550781E-05_wp, -1.7675478921166E-04_wp, -6.9637303501062E-05_wp, &
   & -1.3972177826372E-08_wp, -2.5930147844554E-05_wp, +5.6706497162842E-09_wp, &
   & +7.1736454241451E-05_wp, -6.4901597970604E-05_wp, +1.0260731013534E-08_wp, &
   & +7.7101693674211E-03_wp, -6.8583411715455E-03_wp, +1.1963510029443E-02_wp, &
   & +1.1973998912957E-02_wp, -1.1019258633235E-02_wp, +2.9078826501523E-03_wp, &
   & -8.4374693288628E-03_wp, -1.9088941687601E-02_wp, -8.4544157891327E-03_wp, &
   & +1.5873123660660E-02_wp, +7.0804247943218E-03_wp, +3.5069948504052E-02_wp, &
   & -5.9349258719369E-03_wp, +1.0995416506821E-02_wp, -9.8850860212807E-03_wp, &
   & +2.0855653931009E-02_wp, -8.3251580263389E-08_wp, +2.5257851949662E-07_wp, &
   & +6.1781220463466E-05_wp, +2.2037038994418E-07_wp, +1.0413027116948E-07_wp, &
   & -2.9824363899185E-05_wp, -3.3505747497459E-05_wp, +1.7475460218587E-08_wp, &
   & -1.4569102046574E-07_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +1.2734757828898E-08_wp, -3.8614514369150E-08_wp, &
   & -3.3728474919912E-08_wp, +6.1851944283869E-05_wp, +5.6706497162842E-09_wp, &
   & -2.9879351678402E-05_wp, +2.2288833688563E-08_wp, -1.5119176442554E-08_wp, &
   & -3.3530456649791E-05_wp, +2.8763906866208E-02_wp, -1.1773659788908E-02_wp, &
   & +4.4631612080258E-02_wp, -6.8583411715455E-03_wp, -4.1108945077173E-02_wp, &
   & -8.4374693288628E-03_wp, -2.6307657509996E-02_wp, -3.7477015603492E-02_wp, &
   & +2.6868453736935E-02_wp, -6.2041436166685E-03_wp, +1.2390998028010E-02_wp, &
   & -3.5753546579448E-03_wp, -2.0590330181413E-02_wp, -9.5837432966168E-04_wp, &
   & -2.1452504678938E-02_wp, -6.2076506831360E-03_wp, -8.3327940335095E-08_wp, &
   & +2.2083351813289E-07_wp, +6.1837887476990E-05_wp, +2.5257851949662E-07_wp, &
   & +1.0422578160842E-07_wp, -3.3505747497459E-05_wp, -2.9885800066366E-05_wp, &
   & -1.7192277609346E-08_wp, -1.4585644937581E-07_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +1.6110082935387E-04_wp, &
   & -4.2664028577479E-04_wp, -4.2668147721732E-04_wp, -3.8614514369150E-08_wp, &
   & +7.1736454241451E-05_wp, +2.2288833688563E-08_wp, +2.5208514410279E-04_wp, &
   & -1.2420395773777E-04_wp, +2.2286768828546E-08_wp, -4.9765510063313E-02_wp, &
   & -7.2271918612763E-03_wp, +1.1873829350932E-02_wp, +2.5668994476862E-02_wp, &
   & +2.0574445695289E-02_wp, -1.9088941687601E-02_wp, -3.7477015603492E-02_wp, &
   & +3.6312544493722E-02_wp, -5.4309124159528E-02_wp, +1.4198662349598E-02_wp, &
   & -2.2122096057885E-03_wp, +1.0995416506821E-02_wp, -1.5908577325246E-03_wp, &
   & -3.0027270828935E-03_wp, -5.0237091689407E-03_wp, -4.3478903642740E-03_wp, &
   & -1.4760110148966E-07_wp, -6.1390208475963E-05_wp, -2.3156409435677E-10_wp, &
   & +6.2228750438940E-05_wp, +1.3141261428099E-07_wp, +1.7475460218587E-08_wp, &
   & -1.7192277609346E-08_wp, -6.3360738357634E-05_wp, -2.8904960247923E-07_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, &
   & -8.0544385641901E-05_wp, +1.8238051699945E-04_wp, +2.4424611502933E-04_wp, &
   & +2.4194741717859E-08_wp, -6.4901597970604E-05_wp, -1.5119176442554E-08_wp, &
   & -1.2420395773777E-04_wp, +4.8986970621514E-05_wp, -1.2467715196643E-08_wp, &
   & +2.8744631281347E-02_wp, -1.1765769894832E-02_wp, -6.8583411715455E-03_wp, &
   & +4.4640807135904E-02_wp, -1.1883829876892E-02_wp, -8.4544157891327E-03_wp, &
   & +2.6868453736935E-02_wp, -5.4309124159528E-02_wp, -2.6343680350078E-02_wp, &
   & -9.4010973066397E-03_wp, +2.1466297042406E-02_wp, -7.9681358032705E-03_wp, &
   & -1.6883049306225E-02_wp, -5.5704921581408E-03_wp, -1.7665770147214E-02_wp, &
   & -3.7539365579622E-02_wp, +1.6099589098168E-04_wp, -4.2666708030283E-04_wp, &
   & +2.5257851949662E-07_wp, -4.2616280871542E-04_wp, -1.4333829970694E-04_wp, &
   & -1.4569102046574E-07_wp, -1.4585644937581E-07_wp, -2.8904960247923E-07_wp, &
   & +2.5191983004583E-04_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999983021E-01_wp, +1.2733804737693E-08_wp, -3.3722694750107E-08_wp, &
   & -3.8614514369150E-08_wp, +6.1847315177850E-05_wp, +1.0260731013534E-08_wp, &
   & -3.3530456649791E-05_wp, +2.2286768828546E-08_wp, -1.2467715196643E-08_wp, &
   & -2.9874332536345E-05_wp, +7.2541790306090E-02_wp, +9.6842287199670E-02_wp, &
   & +3.6115328478804E-01_wp, -9.6769352970151E-02_wp, +8.7334312644183E-02_wp, &
   & -4.3668985004930E-02_wp, +4.3701897943556E-02_wp, -8.8221930945365E-06_wp, &
   & -1.1709721510764E-02_wp, +1.2981125767590E-03_wp, -1.1875975300214E-02_wp, &
   & +2.7024899774620E-02_wp, +3.3478892754692E-02_wp, -2.7004546679915E-02_wp, &
   & -8.9474499618165E-06_wp, +1.3010499205939E-03_wp, +1.1404426518944E-04_wp, &
   & -1.7118096128378E-07_wp, +3.1757417749217E-04_wp, -3.1724130066524E-04_wp, &
   & +4.6630807922303E-05_wp, -1.6102719029378E-04_wp, -8.6889031060939E-08_wp, &
   & +8.0429178500790E-05_wp, +8.6797955189522E-08_wp, +1.1409568034293E-04_wp, &
   & +3.1752651913565E-04_wp, +3.1755028514580E-04_wp, +2.5099953499080E-08_wp, &
   & +4.6516245550781E-05_wp, +1.2734757828898E-08_wp, +1.6110082935387E-04_wp, &
   & -8.0544385641901E-05_wp, +1.2733804737693E-08_wp, +9.9999999986933E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -3.1238229544784E-02_wp, &
   & +1.0609152552078E-01_wp, -6.9190091296643E-02_wp, +1.8539165082359E-02_wp, &
   & -5.5013472109314E-02_wp, +2.3268206571198E-02_wp, +3.1482925747474E-02_wp, &
   & -1.4681371438029E-02_wp, -8.4357044017429E-03_wp, -8.0651671840295E-04_wp, &
   & -7.1499491235581E-03_wp, +1.5040286097405E-02_wp, -3.1944682425620E-02_wp, &
   & +1.7932469062252E-02_wp, -1.4501064908625E-02_wp, +3.9558072278322E-03_wp, &
   & +1.7118096128378E-07_wp, +1.1219727395084E-04_wp, +4.1646460064375E-07_wp, &
   & -4.1602806825348E-07_wp, +9.5511237798258E-08_wp, -2.6335006312020E-07_wp, &
   & +6.1853888097456E-05_wp, +1.6487794718374E-07_wp, -6.1789053713988E-05_wp, &
   & -3.1752651913565E-04_wp, -6.5980252646670E-04_wp, -7.7210506875701E-04_wp, &
   & -6.1029078633347E-08_wp, -1.7675478921166E-04_wp, -3.8614514369150E-08_wp, &
   & -4.2664028577479E-04_wp, +1.8238051699945E-04_wp, -3.3722694750107E-08_wp, &
   & +0.0000000000000E+00_wp, +9.9999999999806E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -1.1649651755747E-01_wp, -6.9190091296643E-02_wp, -1.3338547475478E-01_wp, &
   & +6.9137982593462E-02_wp, -1.1029925038494E-01_wp, +7.2098953192111E-02_wp, &
   & -7.2153293553380E-02_wp, +1.7530443499088E-05_wp, +2.3268206571198E-02_wp, &
   & -2.9943617039990E-03_wp, +2.3507385642345E-02_wp, -4.3988891340934E-02_wp, &
   & -3.8331555743657E-02_wp, +4.3955762260755E-02_wp, +1.7710642827295E-05_wp, &
   & -3.0011372872945E-03_wp, -3.1757417749217E-04_wp, +4.1646460064375E-07_wp, &
   & -6.6042582376117E-04_wp, +7.7181346919900E-04_wp, -7.0057711469212E-05_wp, &
   & +4.2677670010054E-04_wp, +2.3028541877598E-07_wp, -2.4402682285130E-04_wp, &
   & -2.6335006312020E-07_wp, -3.1755028514580E-04_wp, -7.7210506875701E-04_wp, &
   & -6.5991810213760E-04_wp, -6.1033646496549E-08_wp, -6.9637303501062E-05_wp, &
   & -3.3728474919912E-08_wp, -4.2668147721732E-04_wp, +2.4424611502933E-04_wp, &
   & -3.8614514369150E-08_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999999806E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +3.1214703291230E-02_wp, +1.8539165082359E-02_wp, &
   & +6.9137982593462E-02_wp, +1.0611946061625E-01_wp, +5.4972040155180E-02_wp, &
   & +3.1517986634472E-02_wp, +2.3268206571198E-02_wp, -1.4679708950635E-02_wp, &
   & +8.4514638026962E-03_wp, -3.9582287881061E-03_wp, +7.1664066284969E-03_wp, &
   & +1.7932469062252E-02_wp, +3.1920624125601E-02_wp, +1.5067307014100E-02_wp, &
   & -1.4501204125470E-02_wp, +8.0055422357969E-04_wp, +3.1724130066524E-04_wp, &
   & -4.1602806825348E-07_wp, +7.7181346919900E-04_wp, -6.5880696664070E-04_wp, &
   & +1.7700630420597E-04_wp, -4.2619975760515E-04_wp, -2.6335006312020E-07_wp, &
   & +1.8198184166980E-04_wp, +2.2973304939934E-07_wp, -2.5099953499080E-08_wp, &
   & -6.1029078633347E-08_wp, -6.1033646496549E-08_wp, +1.1224475179317E-04_wp, &
   & -1.3972177826372E-08_wp, +6.1851944283869E-05_wp, -3.8614514369150E-08_wp, &
   & +2.4194741717859E-08_wp, +6.1847315177850E-05_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999999806E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +5.7475514003498E-02_wp, &
   & +2.1680093834721E-02_wp, -8.3463679766072E-03_wp, -2.1663766040475E-02_wp, &
   & +4.8216046970693E-02_wp, -5.2973934099804E-02_wp, +5.3013860098579E-02_wp, &
   & -1.6599793687759E-05_wp, -2.2032952479852E-02_wp, -1.8191287359940E-03_wp, &
   & +2.2156528844113E-03_wp, +4.9502872598173E-03_wp, -1.7953625020407E-02_wp, &
   & -4.9668267830807E-03_wp, +2.5030729187171E-06_wp, -1.8210478240649E-03_wp, &
   & +4.6630807922303E-05_wp, -9.5511237798258E-08_wp, +7.0057711469212E-05_wp, &
   & -1.7700630420597E-04_wp, -2.5794630113637E-05_wp, -7.1969516677254E-05_wp, &
   & -3.8834196626061E-08_wp, +6.4939862646865E-05_wp, +7.0082119363944E-08_wp, &
   & +4.6516245550781E-05_wp, +1.7675478921166E-04_wp, +6.9637303501062E-05_wp, &
   & +1.3972177826372E-08_wp, -2.5930147844554E-05_wp, +5.6706497162842E-09_wp, &
   & +7.1736454241451E-05_wp, -6.4901597970604E-05_wp, +1.0260731013534E-08_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & -2.8738960474736E-02_wp, -6.8539755877766E-03_wp, -1.1761734282202E-02_wp, &
   & -4.4649557178838E-02_wp, -5.2973934099804E-02_wp, -2.6370131759252E-02_wp, &
   & -2.6857903704922E-02_wp, +1.6861155128907E-02_wp, -8.4600738354531E-03_wp, &
   & +1.3604302953205E-03_wp, +7.0860215765566E-03_wp, -1.1466504086879E-02_wp, &
   & +3.4032638251686E-02_wp, -2.2935587518175E-02_wp, +1.8004216541053E-02_wp, &
   & -5.4308824808427E-03_wp, -1.6102719029378E-04_wp, +2.6335006312020E-07_wp, &
   & -4.2677670010054E-04_wp, +4.2619975760515E-04_wp, -7.1969516677254E-05_wp, &
   & +2.5196902574673E-04_wp, +1.5209261706388E-07_wp, -1.2399343458034E-04_wp, &
   & -1.5189530592425E-07_wp, +1.2734757828898E-08_wp, +3.8614514369150E-08_wp, &
   & +3.3728474919912E-08_wp, -6.1851944283869E-05_wp, +5.6706497162842E-09_wp, &
   & -2.9879351678402E-05_wp, +2.2288833688563E-08_wp, -1.5119176442554E-08_wp, &
   & -3.3530456649791E-05_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +2.8760620782210E-02_wp, -4.4639229504342E-02_wp, &
   & +1.1770599000228E-02_wp, -6.8539755877766E-03_wp, +5.3013860098579E-02_wp, &
   & -2.6857903704922E-02_wp, -2.6329661862102E-02_wp, +1.6861185214554E-02_wp, &
   & +8.4410338787385E-03_wp, +3.7579715801848E-03_wp, -2.4778890068752E-02_wp, &
   & +3.5840896450524E-02_wp, +1.4234076450863E-02_wp, -3.5813903819067E-02_wp, &
   & -1.8668603916302E-05_wp, +3.7664750450234E-03_wp, -8.6889031060939E-08_wp, &
   & -6.1853888097456E-05_wp, -2.3028541877598E-07_wp, +2.6335006312020E-07_wp, &
   & -3.8834196626061E-08_wp, +1.5209261706388E-07_wp, -2.9896698388673E-05_wp, &
   & -1.0307280732346E-07_wp, +3.3513086522452E-05_wp, +1.6110082935387E-04_wp, &
   & +4.2664028577479E-04_wp, +4.2668147721732E-04_wp, +3.8614514369150E-08_wp, &
   & +7.1736454241451E-05_wp, +2.2288833688563E-08_wp, +2.5208514410279E-04_wp, &
   & -1.2420395773777E-04_wp, +2.2286768828546E-08_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, -5.8059663767369E-06_wp, &
   & +1.3807765718289E-02_wp, -5.1638372480230E-06_wp, +1.3800134014195E-02_wp, &
   & -1.6599793687762E-05_wp, +1.6861155128907E-02_wp, +1.6861185214554E-02_wp, &
   & +6.5698399264750E-04_wp, +1.6985086959520E-06_wp, +5.4349699818026E-03_wp, &
   & -7.1078059000031E-03_wp, -2.2935587518175E-02_wp, -3.4007007462481E-02_wp, &
   & -1.1501063778437E-02_wp, +1.8007088403204E-02_wp, -1.3522438795740E-03_wp, &
   & +8.0429178500790E-05_wp, -1.6487794718374E-07_wp, +2.4402682285130E-04_wp, &
   & -1.8198184166980E-04_wp, +6.4939862646865E-05_wp, -1.2399343458034E-04_wp, &
   & -1.0307280732346E-07_wp, +4.8844238134989E-05_wp, +8.4900269928562E-08_wp, &
   & -8.0544385641901E-05_wp, -1.8238051699945E-04_wp, -2.4424611502933E-04_wp, &
   & -2.4194741717859E-08_wp, -6.4901597970604E-05_wp, -1.5119176442554E-08_wp, &
   & -1.2420395773777E-04_wp, +4.8986970621514E-05_wp, -1.2467715196643E-08_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +9.9999999983021E-01_wp, +0.0000000000000E+00_wp, &
   & -7.7062753720979E-03_wp, +1.1960875168992E-02_wp, -6.8539755877766E-03_wp, &
   & -1.1972659316082E-02_wp, -2.2032952479852E-02_wp, -8.4600738354531E-03_wp, &
   & +8.4410338787385E-03_wp, +1.6985086959522E-06_wp, +2.9114180444325E-03_wp, &
   & +1.4568020488924E-03_wp, +2.5030729187197E-06_wp, +1.3454422324185E-02_wp, &
   & -1.3526397406746E-05_wp, +1.3457088366666E-02_wp, -1.1066808990472E-03_wp, &
   & -1.4562525102727E-03_wp, +8.6797955189522E-08_wp, +6.1789053713988E-05_wp, &
   & +2.6335006312020E-07_wp, -2.2973304939934E-07_wp, +7.0082119363944E-08_wp, &
   & -1.5189530592425E-07_wp, +3.3513086522452E-05_wp, +8.4900269928562E-08_wp, &
   & -2.9826405628944E-05_wp, +1.2733804737693E-08_wp, +3.3722694750107E-08_wp, &
   & +3.8614514369150E-08_wp, -6.1847315177850E-05_wp, +1.0260731013534E-08_wp, &
   & -3.3530456649791E-05_wp, +2.2286768828546E-08_wp, -1.2467715196643E-08_wp, &
   & -2.9874332536345E-05_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, +0.0000000000000E+00_wp, &
   & +9.9999999983021E-01_wp],&
   & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "CeCl3")
   call test_overlap_diat_mol(error, mol, overlap)

end subroutine test_overlap_diat_cecl3

subroutine test_overlap_grad_ss(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(1, 1), doverlapi(3, 1, 1), doverlapj(3, 1, 1), sr(1, 1), sl(1, 1)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 2, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 1, 0, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   do i = 1, 3
      call check(error, doverlapi(i, 1, 1), -doverlapj(i, 1, 1), thr=thr)
      if (allocated(error)) exit
   end do
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   do i = 1, 3
      call check(error, doverlapi(i, 1, 1), doverlapj(i, 1, 1), thr=thr)
      if (allocated(error)) exit
   end do
   if (allocated(error)) return

end subroutine test_overlap_grad_ss


subroutine test_overlap_grad_pp(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i, j, k
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(3, 3), doverlapi(3, 3, 3), doverlapj(3, 3, 3), sr(3, 3), sl(3, 3)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 3, 1, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 2, 1, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   lp: do i = 1, 3
      do j = 1, 3
         do k = 1, 3
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit
         end do
      end do
   end do lp
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   num: do i = 1, 3
      do j = 1, 3
         do k = 1, 3
            call check(error, doverlapi(i, j, k), doverlapj(i, j, k), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_grad_pp


subroutine test_overlap_grad_dd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i, j, k
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(5, 5), doverlapi(3, 5, 5), doverlapj(3, 5, 5), sl(5, 5), sr(5, 5)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 4, 2, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   lp: do i = 1, 3
      do j = 1, 5
         do k = 1, 5
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit lp
         end do
      end do
   end do lp
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   num: do i = 1, 3
      do j = 1, 5
         do k = 1, 5
            call check(error, doverlapi(i, j, k), doverlapj(i, j, k), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_grad_dd


subroutine test_overlap_grad_ff(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i, j, k
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(7, 7), doverlapi(3, 7, 7), doverlapj(3, 7, 7), sl(7, 7), sr(7, 7)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 5, 3, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   lp: do i = 1, 3
      do j = 1, 7
         do k = 1, 7
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit lp
         end do
      end do
   end do lp
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   num: do i = 1, 3
      do j = 1, 7
         do k = 1, 7
            call check(error, doverlapi(i, j, k), doverlapj(i, j, k), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_grad_ff

subroutine test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)
   !> Vector between the two centers
   real(wp), intent(inout) :: vec(3)
   !> Scaling factors for the diatomic frame overlap
   real(wp), intent(in) :: ksig, kpi, kdel
   !> CGTOs for the tested diatomic frame overlap calculation
   type(cgto_type), intent(in) :: cgtoi, cgtoj
   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer :: stat, i, j, k
   real(wp) :: r2
   real(wp) :: overlap(msao(cgtoi%ang), msao(cgtoj%ang)), overlap_scaled(msao(cgtoi%ang), msao(cgtoj%ang)), &
   & sl(msao(cgtoj%ang), msao(cgtoi%ang)), sr(msao(cgtoj%ang), msao(cgtoi%ang)), &
   & sl_scaled(msao(cgtoj%ang), msao(cgtoi%ang)), sr_scaled(msao(cgtoj%ang), msao(cgtoi%ang))

   real(wp) :: doverlapi(3, msao(cgtoi%ang), msao(cgtoj%ang)),  doverlapi_scaled(3, msao(cgtoi%ang), msao(cgtoj%ang)), &
   & doverlapj(3, msao(cgtoj%ang), msao(cgtoi%ang)), doverlapj_scaled(3, msao(cgtoj%ang), msao(cgtoi%ang)), &
   & doverlaptmp(3, msao(cgtoj%ang), msao(cgtoi%ang)), doverlaptmp_scaled(3, msao(cgtoj%ang), msao(cgtoi%ang))

   real(wp), parameter :: step = 1.0e-6_wp

   r2 = sum(vec**2)
   
   ! Test antisymmetry w.r.t. the exchange of the two centers
   call overlap_grad_cgto_diat_scal(cgtoi, cgtoj, r2, vec, 100.0_wp, & 
   & ksig, kpi, kdel, overlap, doverlapi, overlap_scaled, doverlapi_scaled)

   vec(:) = -vec

   call overlap_grad_cgto_diat_scal(cgtoj, cgtoi, r2, vec, 100.0_wp, & 
   & ksig, kpi, kdel, overlap, doverlapj, overlap_scaled, doverlapj_scaled)

   lp: do i = 1, 3
      do j = 1, msao(cgtoi%ang)
         do k = 1, msao(cgtoj%ang)
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit lp
            call check(error, doverlapi_scaled(i, j, k), -doverlapj_scaled(i, k, j), thr=thr)
            if (allocated(error)) exit lp
         end do
      end do
   end do lp
   if (allocated(error)) return

   ! Test the analytical againts the numerical gradient
   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto_diat_scal(cgtoj, cgtoi, r2, vec,&
      & 100.0_wp, ksig, kpi, kdel, sr, sr_scaled)

      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto_diat_scal(cgtoj, cgtoi, r2, vec,&
      & 100.0_wp, ksig, kpi, kdel, sl, sl_scaled)

      vec(i) = vec(i) + step
      doverlaptmp(i, :, :) = 0.5_wp * (sr - sl) / step
      doverlaptmp_scaled(i, :, :) = 0.5_wp * (sr_scaled - sl_scaled) / step
   end do

   num: do i = 1, 3
      do j = 1, msao(cgtoi%ang) 
         do k = 1, msao(cgtoj%ang)
            call check(error, doverlapj(i, k, j), doverlaptmp(i, k, j), thr=thr)
            if (allocated(error)) exit num
            call check(error, doverlapj_scaled(i, k, j), doverlaptmp_scaled(i, k, j), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_diat_grad_gen

subroutine test_overlap_diat_grad_ss(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 2, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 1, 0, 2.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ss

subroutine test_overlap_diat_grad_ss_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 2, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 1, 0, 2.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ss_z

subroutine test_overlap_diat_grad_sp(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 1, 2.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sp

subroutine test_overlap_diat_grad_sp_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 1, 2.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sp_z

subroutine test_overlap_diat_grad_pp(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 3, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 2, 1, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pp

subroutine test_overlap_diat_grad_pp_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 3, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 2, 1, 1.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pp_z

subroutine test_overlap_diat_grad_sd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat


   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.8_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sd

subroutine test_overlap_diat_grad_sd_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.8_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sd_z

subroutine test_overlap_diat_grad_pd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.5_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pd

subroutine test_overlap_diat_grad_pd_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.5_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pd_z

subroutine test_overlap_diat_grad_dd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 2, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.3_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.7
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.7_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_dd

subroutine test_overlap_diat_grad_dd_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 2, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.3_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.7_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_dd_z

subroutine test_overlap_diat_grad_sf(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 0, 2.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sf

subroutine test_overlap_diat_grad_sf_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 0, 2.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sf_z

subroutine test_overlap_diat_grad_pf(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat, i

   call slater_to_gauss(ng, 5, 1, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 2.0_wp, cgtoj, .true., stat)


   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp
   
   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pf

subroutine test_overlap_diat_grad_pf_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 1, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 2.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pf_z

subroutine test_overlap_diat_grad_df(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat
   
   call slater_to_gauss(ng, 5, 2, 1.3_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.4_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_df

subroutine test_overlap_diat_grad_df_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat
   
   call slater_to_gauss(ng, 5, 2, 1.3_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.4_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_df_z

subroutine test_overlap_diat_grad_ff(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 3, 1.6_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.1_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ff

subroutine test_overlap_diat_grad_ff_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 3, 1.6_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ff_z

end module test_integral_overlap
