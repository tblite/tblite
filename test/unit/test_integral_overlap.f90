! This file is part of tblite.
! SPDX-Identifier: LGPL-3.0-or-later
!
! tblite is free software: you can redistribute it and/or modify it under
! the terms of the GNU Lesser General Public License as published by
! the Free Software Foundation, either version 3 of the License, or
! (at your option) any later version.
!
! tblite is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU Lesser General Public License for more details.
!
! You should have received a copy of the GNU Lesser General Public License
! along with tblite.  If not, see <https://www.gnu.org/licenses/>.

module test_integral_overlap
   use mctc_env, only : wp
   use mctc_env_testing, only : new_unittest, unittest_type, error_type, check, &
      & test_failed
   use mctc_io, only : structure_type
   use mstore, only : get_structure
   use tblite_basis_type
   use tblite_basis_slater, only : slater_to_gauss
   use tblite_cutoff, only : get_lattice_points
   use tblite_integral_overlap
   
   implicit none
   private

   public :: collect_integral_overlap

   real(wp), parameter :: thr = 5e+6_wp*epsilon(1.0_wp)
   real(wp), parameter :: thr2 = sqrt(epsilon(1.0_wp))

contains


!> Collect all exported unit tests
subroutine collect_integral_overlap(testsuite)

   !> Collection of tests
   type(unittest_type), allocatable, intent(out) :: testsuite(:)

   testsuite = [ &
      new_unittest("overlap-alh3", test_overlap_alh3), &
      new_unittest("overlap-diat-alh3", test_overlap_diat_alh3), &
      new_unittest("overlap-bh3", test_overlap_bh3), &
      new_unittest("overlap-beh2", test_overlap_beh2), &
      new_unittest("overlap-ch4", test_overlap_ch4), &
      new_unittest("overlap-cl2", test_overlap_cl2), &
      new_unittest("overlap-diat-cl2", test_overlap_diat_cl2), &
      new_unittest("overlap-f2", test_overlap_f2), &
      new_unittest("overlap-h2", test_overlap_h2), &
      new_unittest("overlap-lih", test_overlap_lih), &
      new_unittest("overlap-diat-cecl3", test_overlap_diat_cecl3), &
      new_unittest("overlap-grad-ss", test_overlap_grad_ss), &
      new_unittest("overlap-grad-pp", test_overlap_grad_pp), &
      new_unittest("overlap-grad-dd", test_overlap_grad_dd), &
      new_unittest("overlap-grad-ff", test_overlap_grad_ff), &
      new_unittest("overlap-diat-grad-ss", test_overlap_diat_grad_ss), &
      new_unittest("overlap-diat-grad-ss_z", test_overlap_diat_grad_ss_z), &
      new_unittest("overlap-diat-grad-sp", test_overlap_diat_grad_sp), &
      new_unittest("overlap-diat-grad-sp_z", test_overlap_diat_grad_sp_z), &
      new_unittest("overlap-diat-grad-pp", test_overlap_diat_grad_pp), &
      new_unittest("overlap-diat-grad-pp_z", test_overlap_diat_grad_pp_z), &
      new_unittest("overlap-diat-grad-sd", test_overlap_diat_grad_sd), &
      new_unittest("overlap-diat-grad-sd_z", test_overlap_diat_grad_sd_z), &
      new_unittest("overlap-diat-grad-pd", test_overlap_diat_grad_pd), &
      new_unittest("overlap-diat-grad-pd_z", test_overlap_diat_grad_pd_z), &
      new_unittest("overlap-diat-grad-dd", test_overlap_diat_grad_dd), &
      new_unittest("overlap-diat-grad-dd_z", test_overlap_diat_grad_dd_z), &
      new_unittest("overlap-diat-grad-sf", test_overlap_diat_grad_sf), &
      new_unittest("overlap-diat-grad-sf_z", test_overlap_diat_grad_sf_z), &
      new_unittest("overlap-diat-grad-pf", test_overlap_diat_grad_pf), &
      new_unittest("overlap-diat-grad-pf_z", test_overlap_diat_grad_pf_z), &
      new_unittest("overlap-diat-grad-df", test_overlap_diat_grad_df), &
      new_unittest("overlap-diat-grad-df_z", test_overlap_diat_grad_df_z), &
      new_unittest("overlap-diat-grad-ff", test_overlap_diat_grad_ff), & 
      new_unittest("overlap-diat-grad-ff_z", test_overlap_diat_grad_ff_z) & 
      ]

end subroutine collect_integral_overlap


subroutine make_basis(bas, mol, ng)
   type(basis_type), intent(out) :: bas
   type(structure_type), intent(in) :: mol
   integer, intent(in) :: ng


   integer, parameter :: nsh(86) = [&
   & 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3, 3, 3, 3, 3, 3, 2, 3, & ! 1-20
   & 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, & ! 21-40
   & 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 4, 3, 3, & ! 41-60
   & 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, & ! 61-80
   & 3, 3, 3, 3, 3, 3]
   integer, parameter :: lsh(4, 86) = reshape([&
   & 0, 0, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0, & ! 1-6
   & 0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 0, 0,  0, 1, 2, 0, & ! 7-12 
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 13-18
   & 0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 19-24
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 0, 0, & ! 25-30
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 31-36
   & 0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 37-42
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 0, 0, & ! 43-48
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 49-54
   & 0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 3,  0, 1, 2, 0,  0, 1, 2, 0, & ! 55-60
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 61-66
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 67-72
   & 0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 73-78
   & 0, 1, 2, 0,  0, 1, 0, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0,  0, 1, 2, 0, & ! 79-84
   & 0, 1, 2, 0,  0, 1, 2, 0], &
      & shape(lsh))
   integer, parameter :: pqn(4, 86) = reshape([&
   & 1, 0, 0, 0,  1, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0, & ! 1-6
   & 2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 0, 0,  2, 2, 3, 0,  3, 3, 0, 0,  3, 3, 3, 0, & ! 7-12 
   & 3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0,  3, 3, 3, 0, & ! 13-18
   & 4, 4, 0, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0, & ! 19-24
   & 4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 3, 0,  4, 4, 0, 0, & ! 25-30
   & 4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0,  4, 4, 4, 0, & ! 31-36
   & 5, 5, 0, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0, & ! 37-42
   & 5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 4, 0,  5, 5, 0, 0, & ! 43-48
   & 5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0,  5, 5, 5, 0, & ! 49-54
   & 6, 6, 0, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 4,  6, 6, 5, 0,  6, 6, 5, 0, & ! 55-60
   & 6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 61-66
   & 6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 67-72
   & 6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 73-78
   & 6, 6, 5, 0,  6, 6, 0, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0,  6, 6, 5, 0, & ! 79-84
   & 6, 6, 5, 0,  6, 6, 5, 0], &
      & shape(pqn))
   real(wp), parameter :: zeta(4, 86) = reshape([&
   & 1.230000_wp, 0.000000_wp, 0.000000_wp, 0.000000_wp, & 
   & 1.669667_wp, 1.500000_wp, 0.000000_wp, 0.000000_wp, & ! 2
   & 0.750060_wp, 0.557848_wp, 0.000000_wp, 0.000000_wp, &
   & 1.034720_wp, 0.949332_wp, 0.000000_wp, 0.000000_wp, &
   & 1.479444_wp, 1.479805_wp, 0.000000_wp, 0.000000_wp, &
   & 2.096432_wp, 1.800000_wp, 0.000000_wp, 0.000000_wp, &
   & 2.339881_wp, 2.014332_wp, 0.000000_wp, 0.000000_wp, &
   & 2.439742_wp, 2.137023_wp, 0.000000_wp, 0.000000_wp, &
   & 2.416361_wp, 2.308399_wp, 0.000000_wp, 0.000000_wp, &
   & 3.084104_wp, 2.312051_wp, 2.815609_wp, 0.000000_wp, & ! 10
   & 0.763787_wp, 0.573553_wp, 0.000000_wp, 0.000000_wp, &
   & 1.184203_wp, 0.717769_wp, 1.300000_wp, 0.000000_wp, &
   & 1.352531_wp, 1.391201_wp, 1.000000_wp, 0.000000_wp, &
   & 1.773917_wp, 1.718996_wp, 1.250000_wp, 0.000000_wp, &
   & 1.816945_wp, 1.903247_wp, 1.167533_wp, 0.000000_wp, &
   & 1.981333_wp, 2.025643_wp, 1.702555_wp, 0.000000_wp, &
   & 2.485265_wp, 2.199650_wp, 2.476089_wp, 0.000000_wp, &
   & 2.329679_wp, 2.149419_wp, 1.950531_wp, 0.000000_wp, & ! 18
   & 0.875961_wp, 0.631694_wp, 0.000000_wp, 0.000000_wp, & 
   & 1.267130_wp, 0.786247_wp, 1.380000_wp, 0.000000_wp, &
   & 2.224492_wp, 1.554183_wp, 2.009535_wp, 0.000000_wp, &
   & 2.588796_wp, 0.994410_wp, 1.885617_wp, 0.000000_wp, &
   & 3.043706_wp, 4.030076_wp, 1.663291_wp, 0.000000_wp, &
   & 2.250127_wp, 2.706815_wp, 1.675019_wp, 0.000000_wp, &
   & 2.206053_wp, 2.820197_wp, 1.861022_wp, 0.000000_wp, &
   & 1.572970_wp, 1.986214_wp, 2.837906_wp, 0.000000_wp, &
   & 1.808266_wp, 1.736758_wp, 2.797674_wp, 0.000000_wp, &
   & 2.007589_wp, 2.250756_wp, 2.982916_wp, 0.000000_wp, &
   & 2.181599_wp, 2.384590_wp, 3.095025_wp, 0.000000_wp, &
   & 2.263767_wp, 2.203629_wp, 0.000000_wp, 0.000000_wp, &
   & 2.638221_wp, 2.067523_wp, 2.113616_wp, 0.000000_wp, &
   & 2.528919_wp, 2.194417_wp, 1.776619_wp, 0.000000_wp, &
   & 3.556676_wp, 2.420754_wp, 1.465797_wp, 0.000000_wp, &
   & 2.896526_wp, 2.454218_wp, 2.278836_wp, 0.000000_wp, &
   & 3.289210_wp, 2.565269_wp, 1.645016_wp, 0.000000_wp, &
   & 5.209881_wp, 2.843367_wp, 2.758388_wp, 0.000000_wp, & ! 36
   & 1.269729_wp, 1.887305_wp, 0.000000_wp, 0.000000_wp, &
   & 1.868807_wp, 1.785463_wp, 2.160122_wp, 0.000000_wp, &
   & 0.920018_wp, 1.457324_wp, 2.229013_wp, 0.000000_wp, &
   & 6.506473_wp, 1.432023_wp, 2.119714_wp, 0.000000_wp, &
   & 2.109733_wp, 2.799447_wp, 2.018973_wp, 0.000000_wp, &
   & 2.584133_wp, 3.027953_wp, 2.087336_wp, 0.000000_wp, &
   & 2.621415_wp, 3.134876_wp, 2.132598_wp, 0.000000_wp, &
   & 2.739844_wp, 2.181678_wp, 2.546096_wp, 0.000000_wp, &
   & 1.840571_wp, 2.974826_wp, 3.106937_wp, 0.000000_wp, &
   & 1.756228_wp, 3.394247_wp, 3.202653_wp, 0.000000_wp, &
   & 3.050188_wp, 2.349519_wp, 3.353329_wp, 0.000000_wp, &
   & 2.419991_wp, 2.288929_wp, 0.000000_wp, 0.000000_wp, &
   & 2.878139_wp, 2.446597_wp, 2.757735_wp, 0.000000_wp, &
   & 3.038232_wp, 2.320821_wp, 1.775133_wp, 0.000000_wp, &
   & 2.687507_wp, 2.385653_wp, 2.125961_wp, 0.000000_wp, &
   & 2.810717_wp, 2.452747_wp, 2.018718_wp, 0.000000_wp, &
   & 2.906869_wp, 2.493771_wp, 1.900737_wp, 0.000000_wp, &
   & 4.175313_wp, 2.869379_wp, 2.968948_wp, 0.000000_wp, & ! 54
   & 1.242993_wp, 1.991420_wp, 0.000000_wp, 0.000000_wp, &
   & 1.314003_wp, 1.164384_wp, 2.127596_wp, 0.000000_wp, &
   & 2.817373_wp, 1.698633_wp, 2.273697_wp, 0.000000_wp, &
   & 2.845039_wp, 1.460181_wp, 2.534989_wp, 2.534989_wp, &
   & 2.816971_wp, 1.475453_wp, 2.543502_wp, 0.000000_wp, &
   & 2.788903_wp, 1.490724_wp, 2.552016_wp, 0.000000_wp, &
   & 2.760835_wp, 1.505995_wp, 2.560529_wp, 0.000000_wp, &
   & 2.732767_wp, 1.521266_wp, 2.569042_wp, 0.000000_wp, &
   & 2.704699_wp, 1.536537_wp, 2.577556_wp, 0.000000_wp, &
   & 2.676631_wp, 1.551808_wp, 2.586069_wp, 0.000000_wp, &
   & 2.648563_wp, 1.567079_wp, 2.594583_wp, 0.000000_wp, &
   & 2.620495_wp, 1.582351_wp, 2.603096_wp, 0.000000_wp, &
   & 2.592427_wp, 1.597622_wp, 2.611609_wp, 0.000000_wp, &
   & 2.564359_wp, 1.612893_wp, 2.620123_wp, 0.000000_wp, &
   & 2.536291_wp, 1.628164_wp, 2.628636_wp, 0.000000_wp, &
   & 2.508223_wp, 1.643435_wp, 2.637150_wp, 0.000000_wp, &
   & 2.480155_wp, 1.658706_wp, 2.645663_wp, 0.000000_wp, &
   & 3.195377_wp, 2.248538_wp, 2.414921_wp, 0.000000_wp, &
   & 3.141220_wp, 2.487234_wp, 2.219335_wp, 0.000000_wp, &
   & 3.176612_wp, 3.395385_wp, 2.375027_wp, 0.000000_wp, &
   & 3.145383_wp, 2.583611_wp, 2.471393_wp, 0.000000_wp, &
   & 1.815656_wp, 2.481062_wp, 3.185853_wp, 0.000000_wp, &
   & 2.117984_wp, 2.858570_wp, 3.470484_wp, 0.000000_wp, &
   & 2.712412_wp, 3.378860_wp, 3.641249_wp, 0.000000_wp, &
   & 2.805724_wp, 2.825702_wp, 3.720644_wp, 0.000000_wp, &
   & 2.619513_wp, 2.696078_wp, 0.000000_wp, 0.000000_wp, &
   & 3.053831_wp, 2.616838_wp, 3.321796_wp, 0.000000_wp, &
   & 3.021350_wp, 2.592502_wp, 4.246744_wp, 0.000000_wp, &
   & 3.164052_wp, 2.632387_wp, 3.046255_wp, 0.000000_wp, &
   & 2.961334_wp, 2.713884_wp, 2.310225_wp, 0.000000_wp, &
   & 2.982405_wp, 2.959607_wp, 2.437783_wp, 0.000000_wp, &
   & 3.079362_wp, 2.685897_wp, 2.103113_wp, 0.000000_wp], & ! 86
      & shape(zeta))

   integer :: isp, izp, ish, stat
   integer, allocatable :: nshell(:)
   type(cgto_type), allocatable :: cgto(:, :)

   nshell = nsh(mol%num)
   allocate(cgto(maxval(nshell), mol%nid))
   do isp = 1, mol%nid
      izp = mol%num(isp)
      do ish = 1, nshell(isp)
         call slater_to_gauss(ng, pqn(ish, izp), lsh(ish, izp), zeta(ish, izp), &
            & cgto(ish, isp), .true., stat)
      end do
   end do

   call new_basis(bas, mol, nshell, cgto, 1.0_wp)

end subroutine make_basis


subroutine test_overlap_mol(error, mol, ref)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   type(structure_type), intent(in) :: mol
   real(wp), intent(in) :: ref(:, :)

   type(basis_type) :: bas
   real(wp), allocatable :: lattr(:, :), overlap(:, :)
   real(wp) :: cutoff
   integer :: ii, jj

   call make_basis(bas, mol, 6)
   call check(error, bas%nao, size(ref, 1))
   if (allocated(error)) return

   cutoff = get_cutoff(bas)
   call get_lattice_points(mol%periodic, mol%lattice, cutoff, lattr)

   allocate(overlap(bas%nao, bas%nao))
   call get_overlap(mol, lattr, cutoff, bas, overlap)

   !where(abs(overlap) < thr) overlap = 0.0_wp
   !print '(*(6x,"&", 3(es20.14e1, "_wp":, ","), "&", /))', overlap

   do ii = 1, size(overlap, 2)
      do jj = 1, size(overlap, 1)
         call check(error, overlap(jj, ii), ref(jj, ii), thr=thr)
         if (allocated(error)) return
      end do
   end do


end subroutine test_overlap_mol

subroutine test_overlap_diat_mol(error, mol, ref)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   type(structure_type), intent(in) :: mol
   real(wp), intent(in) :: ref(:, :)

   type(basis_type) :: bas
   real(wp), allocatable :: lattr(:, :), overlap(:, :), overlap_scaled(:, :)
   real(wp) :: cutoff
   integer :: ii, jj
   real(wp) :: scalfac(3,86)

   scalfac = 1.2_wp

   call make_basis(bas, mol, 6)
   call check(error, bas%nao, size(ref, 1))
   if (allocated(error)) return

   cutoff = get_cutoff(bas)
   call get_lattice_points(mol%periodic, mol%lattice, cutoff, lattr)

   allocate(overlap(bas%nao, bas%nao), overlap_scaled(bas%nao, bas%nao))
   call get_overlap(mol, lattr, cutoff, bas, scalfac, overlap, overlap_scaled)

   do ii = 1, size(overlap_scaled, 2)
      do jj = 1, size(overlap_scaled, 1)
         call check(error, overlap_scaled(jj, ii), ref(jj, ii), thr=thr)
         if (allocated(error)) return
      end do
   end do


end subroutine test_overlap_diat_mol

subroutine test_overlap_alh3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 12
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869333E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.02664545809937E-1_wp, 4.02664545809937E-1_wp, 4.02664545809939E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.32775379754938E-1_wp,-4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-2.49862982000156E-1_wp, 4.99725964000314E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-3.40183623222704E-1_wp, 3.40183623222704E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.26789082148469E-1_wp,-2.26789082148469E-1_wp,-2.26789082148469E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      &-1.96405106441530E-1_wp,-1.96405106441530E-1_wp, 3.92810212883060E-1_wp,&
      & 4.02664545809937E-1_wp, 4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp,-3.40183623222704E-1_wp, 0.00000000000000E+0_wp,&
      &-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,-1.96405106441530E-1_wp,&
      & 9.99999999881495E-1_wp, 3.54600353330803E-2_wp, 3.54600353330805E-2_wp,&
      & 4.02664545809937E-1_wp,-4.32775379754938E-1_wp, 0.00000000000000E+0_wp,&
      &-2.49862982000156E-1_wp, 3.40183623222704E-1_wp, 0.00000000000000E+0_wp,&
      &-2.26789082148469E-1_wp, 0.00000000000000E+0_wp,-1.96405106441530E-1_wp,&
      & 3.54600353330803E-2_wp, 9.99999999881495E-1_wp, 3.54600353330805E-2_wp,&
      & 4.02664545809939E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.99725964000314E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.26789082148469E-1_wp, 0.00000000000000E+0_wp, 3.92810212883060E-1_wp,&
      & 3.54600353330805E-2_wp, 3.54600353330805E-2_wp, 9.99999999881495E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "AlH3")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_alh3

subroutine test_overlap_diat_alh3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 12
   real(wp), parameter :: overlap_scaled(nao, nao) = reshape([&
      & 9.99999999869333E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.83197454971925E-1_wp, 4.83197454971925E-1_wp, 4.83197454971926E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 5.19330455705926E-1_wp,-5.19330455705926E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.99835578400188E-1_wp,-2.99835578400188E-1_wp, 5.99671156800377E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-4.08220347867244E-1_wp, 4.08220347867244E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.72146898578163E-1_wp,-2.72146898578163E-1_wp,-2.72146898578163E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830206E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      &-2.35686127729836E-1_wp,-2.35686127729836E-1_wp, 4.71372255459672E-1_wp,&
      & 4.83197454971925E-1_wp, 5.19330455705926E-1_wp, 0.00000000000000E+0_wp,&
      &-2.99835578400188E-1_wp,-4.08220347867244E-1_wp, 0.00000000000000E+0_wp,&
      &-2.72146898578163E-1_wp, 0.00000000000000E+0_wp,-2.35686127729836E-1_wp,&
      & 9.99999999881495E-1_wp, 4.25520423996964E-2_wp, 4.25520423996966E-2_wp,&
      & 4.83197454971925E-1_wp,-5.19330455705926E-1_wp, 0.00000000000000E+0_wp,&
      &-2.99835578400188E-1_wp, 4.08220347867244E-1_wp, 0.00000000000000E+0_wp,&
      &-2.72146898578163E-1_wp, 0.00000000000000E+0_wp,-2.35686127729836E-1_wp,&
      & 4.25520423996964E-2_wp, 9.99999999881495E-1_wp, 4.25520423996966E-2_wp,&
      & 4.83197454971927E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 5.99671156800377E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.72146898578163E-1_wp, 0.00000000000000E+0_wp, 4.71372255459672E-1_wp,&
      & 4.25520423996966E-2_wp, 4.25520423996966E-2_wp, 9.99999999881495E-1_wp],&
      & shape(overlap_scaled))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "AlH3")
   call test_overlap_diat_mol(error, mol, overlap_scaled)

end subroutine test_overlap_diat_alh3

subroutine test_overlap_bh3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 7
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 4.80899928496809E-1_wp, 4.80899928496809E-1_wp,&
      & 4.80899928496810E-1_wp, 0.00000000000000E+0_wp, 9.99999999925689E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 4.26420603078617E-1_wp,&
      &-4.26420603078617E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999925689E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp,-2.46194049975443E-1_wp,-2.46194049975443E-1_wp,&
      & 4.92388099950885E-1_wp, 4.80899928496809E-1_wp, 4.26420603078617E-1_wp,&
      & 0.00000000000000E+0_wp,-2.46194049975443E-1_wp, 9.99999999881495E-1_wp,&
      & 1.10583333710332E-1_wp, 1.10583333710331E-1_wp, 4.80899928496809E-1_wp,&
      &-4.26420603078617E-1_wp, 0.00000000000000E+0_wp,-2.46194049975443E-1_wp,&
      & 1.10583333710332E-1_wp, 9.99999999881495E-1_wp, 1.10583333710331E-1_wp,&
      & 4.80899928496810E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.92388099950885E-1_wp, 1.10583333710331E-1_wp, 1.10583333710331E-1_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "BH3")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_bh3

subroutine test_overlap_beh2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 6
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 4.75332491800271E-1_wp, 4.75332491800271E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999925689E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999925689E-1_wp,&
      & 0.00000000000000E+0_wp,-5.55623013601629E-1_wp, 5.55623013601629E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 4.75332491800271E-1_wp, 0.00000000000000E+0_wp,-5.55623013601629E-1_wp,&
      & 0.00000000000000E+0_wp, 9.99999999881495E-1_wp, 4.00645037406879E-2_wp,&
      & 4.75332491800271E-1_wp, 0.00000000000000E+0_wp, 5.55623013601629E-1_wp,&
      & 0.00000000000000E+0_wp, 4.00645037406879E-2_wp, 9.99999999881495E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "BeH2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_beh2

subroutine test_overlap_ch4(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 8
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 4.22144465267144E-1_wp, 4.22144465267144E-1_wp,&
      & 4.22144465267144E-1_wp, 4.22144465267144E-1_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 2.57682345348632E-1_wp,-2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      & 2.57682345348632E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 2.57682345348632E-1_wp,&
      & 2.57682345348632E-1_wp,-2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp,-2.57682345348632E-1_wp, 2.57682345348632E-1_wp,&
      &-2.57682345348632E-1_wp, 2.57682345348632E-1_wp, 4.22144465267144E-1_wp,&
      & 2.57682345348632E-1_wp, 2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      & 9.99999999881495E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 1.71953274424808E-1_wp, 4.22144465267144E-1_wp,-2.57682345348632E-1_wp,&
      & 2.57682345348632E-1_wp, 2.57682345348632E-1_wp, 1.71953274424808E-1_wp,&
      & 9.99999999881495E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 4.22144465267144E-1_wp,-2.57682345348632E-1_wp,-2.57682345348632E-1_wp,&
      &-2.57682345348632E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 9.99999999881495E-1_wp, 1.71953274424808E-1_wp, 4.22144465267144E-1_wp,&
      & 2.57682345348632E-1_wp,-2.57682345348632E-1_wp, 2.57682345348632E-1_wp,&
      & 1.71953274424808E-1_wp, 1.71953274424808E-1_wp, 1.71953274424808E-1_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "CH4")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_ch4

subroutine test_overlap_cl2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 18
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.17210205959034E-2_wp, 0.00000000000000E+0_wp,-1.66880110378166E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,-7.28795473739356E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.66880110378166E-1_wp, 0.00000000000000E+0_wp,-2.43857348208300E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.54878516243462E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 6.66413853324784E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.65407586749691E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,-8.83217466681701E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp,-1.54878516243462E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.20587356016693E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.28795473739356E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-8.83217466681701E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.65407586749691E-2_wp,&
      & 9.17210205959034E-2_wp, 0.00000000000000E+0_wp, 1.66880110378166E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 6.66413853324784E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 7.28795473739356E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-1.66880110378166E-1_wp, 0.00000000000000E+0_wp,-2.43857348208300E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-1.54878516243462E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 6.66413853324784E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.65407586749691E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-7.28795473739356E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,-8.83217466681701E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.08719248478375E-1_wp, 0.00000000000000E+0_wp, 1.54878516243462E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.20587356016693E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-7.28795473739356E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-8.83217466681701E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.65407586749691E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "Cl2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_cl2

subroutine test_overlap_diat_cl2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 18
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.10065224715084E-1_wp, 0.00000000000000E+0_wp,-2.00256132453799E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.30463098174050E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.99696623989741E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,-8.74554568487227E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 2.00256132453799E-1_wp, 0.00000000000000E+0_wp,-2.92628817849960E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.85854219492155E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.99696623989741E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-8.74554568487227E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.98489104099629E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 8.74554568487227E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,-1.05986096001804E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.30463098174050E-1_wp, 0.00000000000000E+0_wp,-1.85854219492155E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.44704827220032E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 8.74554568487227E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-1.05986096001804E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.98489104099629E-2_wp,&
      & 1.10065224715084E-1_wp, 0.00000000000000E+0_wp, 2.00256132453799E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.30463098174050E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999869332E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.99696623989741E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 8.74554568487227E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999998060E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.00256132453799E-1_wp, 0.00000000000000E+0_wp,-2.92628817849960E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-1.85854219492155E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999998060E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 7.99696623989741E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 8.74554568487227E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999998060E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.98489104099629E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-8.74554568487227E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,-1.05986096001804E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830205E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.30463098174050E-1_wp, 0.00000000000000E+0_wp, 1.85854219492155E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 1.44704827220032E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999830206E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-8.74554568487227E-2_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp,-1.05986096001804E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 9.99999999830205E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 1.98489104099629E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 9.99999999830206E-1_wp],&
      & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "Cl2")
   call test_overlap_diat_mol(error, mol, overlap)

end subroutine test_overlap_diat_cl2

subroutine test_overlap_f2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 8
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 1.47958427103274E-1_wp, 0.00000000000000E+0_wp,&
      &-2.00620208590218E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.94087596423658E-2_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 2.00620208590218E-1_wp,&
      & 0.00000000000000E+0_wp,-2.36369347922990E-1_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 7.94087596423658E-2_wp, 1.47958427103274E-1_wp,&
      & 0.00000000000000E+0_wp, 2.00620208590218E-1_wp, 0.00000000000000E+0_wp,&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 7.94087596423658E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      &-2.00620208590218E-1_wp, 0.00000000000000E+0_wp,-2.36369347922990E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 7.94087596423658E-2_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "F2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_f2

subroutine test_overlap_h2(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 2
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 9.99999999881495E-1_wp, 6.61346655776026E-1_wp, 6.61346655776026E-1_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "H2")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_h2

subroutine test_overlap_lih(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 5
   real(wp), parameter :: overlap(nao, nao) = reshape([&
      & 1.00000000000600E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 3.99089038384911E-1_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 4.65790780903622E-1_wp,&
      & 0.00000000000000E+0_wp, 0.00000000000000E+0_wp, 0.00000000000000E+0_wp,&
      & 9.99999999925689E-1_wp, 0.00000000000000E+0_wp, 3.99089038384911E-1_wp,&
      & 0.00000000000000E+0_wp, 4.65790780903622E-1_wp, 0.00000000000000E+0_wp,&
      & 9.99999999881495E-1_wp],shape(overlap))


   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "LiH")
   call test_overlap_mol(error, mol, overlap)

end subroutine test_overlap_lih

subroutine test_overlap_diat_cecl3(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: nao = 43
   real(wp), parameter :: overlap(nao, nao) = reshape([&
   &  1.00000000017687E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  8.70332288839526E-02_wp, -3.75743088618795E-02_wp,&
   &  3.75813237820884E-02_wp, -1.39714048756839E-01_wp,  3.45798058538413E-02_wp,&
   & -9.30153332236999E-03_wp, -3.44310703332351E-02_wp, -3.45862617165372E-02_wp,&
   &  5.96398359439081E-02_wp,  8.70374037059324E-02_wp,  1.39773340235538E-01_wp,&
   &  3.74913880688911E-02_wp,  3.74662639285711E-02_wp,  3.44935575376165E-02_wp,&
   &  3.45166882394490E-02_wp, -3.44713949968698E-02_wp,  9.25220324090528E-03_wp,&
   & -5.97186120759761E-02_wp,  8.70501483673078E-02_wp, -3.74858754537407E-02_wp,&
   & -1.39795821068959E-01_wp,  3.74576439494761E-02_wp, -9.24753044651747E-03_wp,&
   &  3.45127449386520E-02_wp,  6.89706168041974E-02_wp, -3.44867525696831E-02_wp,&
   & -6.96715965207516E-06_wp,  0.00000000000000E+00_wp,  1.00000000002709E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  2.77555756156289E-17_wp,  0.00000000000000E+00_wp,&
   &  5.55111512312578E-17_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  1.16497266239664E-01_wp,&
   &  1.27185027273083E-01_wp,  2.23800362362654E-02_wp, -8.32010466694543E-02_wp,&
   & -5.34993759992540E-02_wp,  1.43906599905847E-02_wp,  1.35687533191725E-03_wp,&
   & -8.27117190825192E-03_wp,  3.08746228065193E-02_wp, -4.33348901004945E-01_wp,&
   & -1.60044731429358E-01_wp, -8.30463228406609E-02_wp, -8.29906709276330E-02_wp,&
   & -1.41189238737982E-02_wp, -1.41283917466891E-02_wp, -5.01351592133483E-03_wp,&
   & -8.23000940585465E-03_wp, -8.67263023353152E-03_wp,  1.16210744639605E-01_wp,&
   &  1.27309830624938E-01_wp, -8.30281095559713E-02_wp,  2.22469980988311E-02_wp,&
   &  1.43530502027905E-02_wp, -5.35670754052100E-02_wp,  2.60161126016657E-02_wp,&
   & -8.22477070533191E-03_wp,  1.65693188619463E-02_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  1.00000000002709E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -5.55111512312578E-17_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   & -1.16519015649088E-01_wp,  2.23800362362654E-02_wp,  1.27176671589586E-01_wp,&
   &  8.32165798547972E-02_wp, -8.27117190825192E-03_wp, -1.43871433346015E-02_wp,&
   &  2.74210445204502E-02_wp, -5.34962879213849E-02_wp, -1.42653009029895E-02_wp,&
   & -1.16237129265320E-01_wp, -8.30463228406609E-02_wp,  1.27288516082972E-01_wp,&
   & -2.22605787670403E-02_wp, -8.23000940585465E-03_wp,  5.35579344963093E-02_wp,&
   &  2.73637142429739E-02_wp,  1.43562120353310E-02_wp,  1.42485952211188E-02_wp,&
   &  4.33383941745651E-01_wp, -8.30281095559713E-02_wp, -1.60062569705741E-01_wp,&
   &  8.29655791121539E-02_wp, -8.22477070533191E-03_wp,  1.41247188002737E-02_wp,&
   & -1.00156415719287E-02_wp, -1.41140811386419E-02_wp, -6.19660469744948E-06_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  1.00000000002709E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  5.55111512312578E-17_wp,  0.00000000000000E+00_wp,&
   & -2.77555756156289E-17_wp,  4.33176423690919E-01_wp, -8.32010466694543E-02_wp,&
   &  8.32165798547972E-02_wp, -1.59808878632637E-01_wp,  1.41373024575003E-02_wp,&
   & -8.27117190825192E-03_wp,  5.04532357407561E-03_wp, -1.41399418153943E-02_wp,&
   & -8.73566869305493E-03_wp, -1.16159235164929E-01_wp, -8.29906709276330E-02_wp,&
   & -2.22605787670403E-02_wp,  1.27318361092920E-01_wp,  5.35689685630853E-02_wp,&
   & -8.23000940585465E-03_wp, -1.34387366290517E-03_wp,  1.43687986955485E-02_wp,&
   &  3.08027933722347E-02_wp, -1.16123223564182E-01_wp,  2.22469980988311E-02_wp,&
   &  8.29655791121539E-02_wp,  1.27343352739503E-01_wp, -1.43671911792981E-02_wp,&
   & -8.22477070533191E-03_wp, -2.59965192485702E-02_wp, -5.35794686146051E-02_wp,&
   &  1.65601608170335E-02_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999778610E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  5.25423280348557E-02_wp,&
   &  3.76133234479980E-02_wp,  2.80724856877327E-02_wp, -8.66996070598103E-02_wp,&
   & -3.13928380664618E-02_wp,  1.01062226584647E-02_wp, -1.42536615921013E-02_wp,&
   & -3.23847235694901E-02_wp,  6.52496331395600E-02_wp,  5.24117329880226E-02_wp,&
   &  8.65303810973684E-02_wp,  2.79344703548215E-02_wp, -3.77935288116399E-02_wp,&
   & -3.16124164200931E-02_wp,  3.22421444843218E-02_wp, -1.42605958522703E-02_wp,&
   & -1.01452989469592E-02_wp, -6.51709489914341E-02_wp, -1.40516658129165E-02_wp,&
   & -1.01228452820915E-02_wp,  2.79218478854371E-02_wp,  1.01417565632354E-02_wp,&
   &  3.49370165331896E-03_wp,  1.01292406544861E-02_wp, -2.64395429758220E-02_wp,&
   & -1.01520886025437E-02_wp,  2.03821043514300E-06_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999778610E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   & -1.41332261122806E-02_wp, -1.01175114428171E-02_wp,  1.01128041839211E-02_wp,&
   &  2.80724856877327E-02_wp,  1.01062226584647E-02_wp,  3.46007075733886E-03_wp,&
   &  1.32819859594181E-02_wp, -1.01005368129228E-02_wp, -2.30060965035419E-02_wp,&
   &  5.24468792661920E-02_wp,  8.65884066704753E-02_wp, -3.77560767510108E-02_wp,&
   &  2.79344703548215E-02_wp,  3.22421444843218E-02_wp, -3.15691890119948E-02_wp,&
   & -4.93307340926079E-02_wp, -1.01249631946354E-02_wp, -4.49724187241898E-02_wp,&
   &  5.24422775322677E-02_wp,  3.77795108969692E-02_wp, -8.65839522640561E-02_wp,&
   &  2.79218478854371E-02_wp,  1.01292406544861E-02_wp, -3.15955942345220E-02_wp,&
   &  6.36166321182948E-02_wp, -3.22294844459063E-02_wp,  2.02334222574644E-02_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999778609E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp, -5.23163316672891E-02_wp,  1.77482357827602E-02_wp,&
   & -4.83521202784524E-02_wp,  6.59939718017320E-02_wp, -1.42536615921013E-02_wp,&
   &  1.32819859594181E-02_wp,  1.49130511639889E-02_wp,  4.93869372486169E-02_wp,&
   & -2.45833086092492E-02_wp, -5.23780577961643E-02_wp, -6.61395790598951E-02_wp,&
   & -4.82683419247890E-02_wp, -1.77287236679529E-02_wp, -1.42605958522703E-02_wp,&
   & -4.93307340926079E-02_wp,  1.50253183734120E-02_wp, -1.32231103598817E-02_wp,&
   &  2.46893348343464E-02_wp,  1.04801175173019E-01_wp, -6.60161665311768E-02_wp,&
   & -1.32359100461928E-01_wp,  6.59664481862163E-02_wp, -2.64395429758220E-02_wp,&
   &  6.36166321182948E-02_wp,  5.78592563648317E-02_wp, -6.35687209197645E-02_wp,&
   & -1.99197524253018E-05_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999778610E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -5.25521374032757E-02_wp,&
   &  2.80724856877327E-02_wp,  3.76028424638346E-02_wp,  8.67157934074529E-02_wp,&
   & -3.23847235694901E-02_wp, -1.01005368129228E-02_wp,  4.93869372486169E-02_wp,&
   & -3.13807470896014E-02_wp, -4.49791451114302E-02_wp,  1.40583935212950E-02_wp,&
   &  2.79344703548215E-02_wp, -1.01205217967675E-02_wp, -1.01373541820083E-02_wp,&
   & -1.01452989469593E-02_wp, -1.01249631946354E-02_wp, -1.32231103598817E-02_wp,&
   &  3.48945918018274E-03_wp, -2.29067300251207E-02_wp, -5.24027820059161E-02_wp,&
   &  2.79218478854371E-02_wp,  8.65187438305330E-02_wp,  3.78215839613670E-02_wp,&
   & -1.01520886025437E-02_wp, -3.22294844459063E-02_wp, -6.35687209197645E-02_wp,&
   & -3.16441581111023E-02_wp,  2.02333861546885E-02_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999778609E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.06198212145744E-02_wp, -6.60715651232787E-02_wp,  4.84166524251350E-02_wp,&
   & -1.14315393138031E-01_wp,  6.52496331395600E-02_wp, -2.30060965035419E-02_wp,&
   & -2.45833086092492E-02_wp, -4.49791451114302E-02_wp,  4.33108632907898E-02_wp,&
   & -9.07403055520738E-02_wp, -1.14594563383586E-01_wp, -4.83628804262418E-02_wp,&
   & -6.59438527478925E-02_wp, -6.51709489914341E-02_wp, -4.49724187241898E-02_wp,&
   &  2.46893348343464E-02_wp, -2.29067300251207E-02_wp,  4.35750533924669E-02_wp,&
   & -1.05866317134359E-05_wp, -1.76176457256347E-02_wp,  2.10365321988993E-05_wp,&
   & -1.76156507407620E-02_wp,  2.03821043514295E-06_wp,  2.02334222574644E-02_wp,&
   & -1.99197524253178E-05_wp,  2.02333861546885E-02_wp,  7.88380791176992E-04_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999954551E-01_wp,  0.00000000000000E+00_wp,  1.11022302462516E-16_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  2.65262804737233E-02_wp,  1.42507277160613E-02_wp,&
   &  1.64520845587426E-02_wp, -4.33629885001251E-02_wp, -1.06197224047312E-02_wp,&
   &  4.30651579672444E-03_wp, -6.18850713917029E-03_wp, -2.09326136855973E-02_wp,&
   &  3.75454402983552E-02_wp,  2.64599835954327E-02_wp,  3.02925797742799E-02_wp,&
   &  1.63709973045090E-02_wp,  3.41160014678714E-02_wp,  3.79081573845803E-02_wp,&
   &  1.58731236606599E-02_wp, -6.20414361666848E-03_wp,  1.41986623495980E-02_wp,&
   & -9.40109730663969E-03_wp,  1.29811257675896E-03_wp, -8.06516718402946E-04_wp,&
   & -2.99436170399896E-03_wp, -3.95822878810612E-03_wp, -1.81912873599402E-03_wp,&
   &  1.36043029532046E-03_wp,  3.75797158018484E-03_wp,  5.43496998180260E-03_wp,&
   &  1.45680204889244E-03_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999954551E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -1.19396457290750E-02_wp,&
   & -7.13257557069311E-03_wp,  7.12847996348055E-03_wp,  2.36204873819870E-02_wp,&
   &  7.04622324062803E-03_wp,  2.18743219017234E-03_wp,  1.24379648278380E-02_wp,&
   & -7.04080373093204E-03_wp, -2.15444415357696E-02_wp, -1.18810440271297E-02_wp,&
   & -2.35164866656702E-02_wp,  7.14679858463501E-03_wp,  7.16144651437762E-03_wp,&
   &  7.09981307416131E-03_wp,  7.08042479432178E-03_wp,  1.23909980280101E-02_wp,&
   & -2.21220960578854E-03_wp,  2.14662970424062E-02_wp, -1.18759753002141E-02_wp,&
   & -7.14994912355814E-03_wp,  2.35073856423452E-02_wp,  7.16640662849692E-03_wp,&
   &  2.21565288441125E-03_wp,  7.08602157655659E-03_wp, -2.47788900687522E-02_wp,&
   & -7.10780590000309E-03_wp,  2.50307291871979E-06_wp,  0.00000000000000E+00_wp,&
   &  2.77555756156289E-17_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  1.11022302462516E-16_wp,&
   &  0.00000000000000E+00_wp,  9.99999999954550E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   & -5.49466777496781E-03_wp, -4.51845862183765E-03_wp, -8.35290361560678E-03_wp,&
   &  8.07339184243267E-03_wp,  4.15769532832945E-03_wp, -2.99023732449633E-03_wp,&
   &  9.35800123003137E-04_wp,  1.10366762058167E-02_wp, -5.55359313937753E-03_wp,&
   &  2.04857407452728E-02_wp,  2.34445908193347E-02_wp,  3.10252761602399E-02_wp,&
   &  8.08162016536220E-03_wp,  6.58560842946932E-03_wp,  3.50699485040518E-02_wp,&
   & -3.57535465794485E-03_wp,  1.09954165068214E-02_wp, -7.96813580327051E-03_wp,&
   &  2.70248997746202E-02_wp,  1.50402860974054E-02_wp, -4.39888913409343E-02_wp,&
   &  1.79324690622517E-02_wp,  4.95028725981733E-03_wp, -1.14665040868790E-02_wp,&
   &  3.58408964505242E-02_wp, -2.29355875181754E-02_wp,  1.34544223241853E-02_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999954551E-01_wp,  0.00000000000000E+00_wp,  5.55111512312578E-17_wp,&
   &  0.00000000000000E+00_wp,  1.76085959125799E-02_wp, -7.89094697640371E-03_wp,&
   & -8.49391724326558E-03_wp, -2.93412223402838E-02_wp,  9.78931808308578E-03_wp,&
   &  1.57131827213755E-03_wp, -2.06016118679948E-02_wp,  5.84269529728236E-03_wp,&
   &  1.68836495770294E-02_wp,  1.75766379725733E-02_wp,  2.93054477839701E-02_wp,&
   & -8.56339623412284E-03_wp,  7.85532948821966E-03_wp,  9.75167393230448E-03_wp,&
   & -5.93492587193690E-03_wp, -2.05903301814128E-02_wp, -1.59085773252457E-03_wp,&
   & -1.68830493062253E-02_wp,  3.34788927546922E-02_wp, -3.19446824256199E-02_wp,&
   & -3.83315557436565E-02_wp,  3.19206241256012E-02_wp, -1.79536250204066E-02_wp,&
   &  3.40326382516863E-02_wp,  1.42340764508628E-02_wp, -3.40070074624808E-02_wp,&
   & -1.35263974067374E-05_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  2.77555756156289E-17_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999954550E-01_wp,&
   &  0.00000000000000E+00_wp, -1.66533453693773E-16_wp, -2.04310419716949E-02_wp,&
   &  8.07339184243267E-03_wp, -3.10589341057993E-02_wp,  2.33299201127748E-02_wp,&
   & -6.55604951437516E-03_wp,  1.10366762058167E-02_wp,  3.47962285860065E-03_wp,&
   &  3.50797021692688E-02_wp, -7.88516878280772E-03_wp,  5.49120574954625E-03_wp,&
   &  8.08162016536220E-03_wp,  8.31632973153208E-03_wp, -4.53878776226461E-03_wp,&
   & -4.18109708914812E-03_wp,  1.09954165068214E-02_wp, -9.58374329661679E-04_wp,&
   & -3.00272708289353E-03_wp, -5.57049215814083E-03_wp, -2.70045466799145E-02_wp,&
   &  1.79324690622517E-02_wp,  4.39557622607554E-02_wp,  1.50673070140999E-02_wp,&
   & -4.96682678308068E-03_wp, -2.29355875181754E-02_wp, -3.58139038190666E-02_wp,&
   & -1.15010637784371E-02_wp,  1.34570883666659E-02_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999954550E-01_wp,  0.00000000000000E+00_wp,&
   & -2.05923224531728E-02_wp,  1.66787249920546E-02_wp,  1.22944986258270E-02_wp,&
   &  3.29444070689262E-02_wp, -2.15444415357697E-02_wp, -4.99763652448016E-03_wp,&
   &  2.14517740482326E-02_wp, -9.78462216776902E-03_wp, -1.76198085660875E-02_wp,&
   &  2.05696225603867E-02_wp,  3.29391434621482E-02_wp, -1.23732349670084E-02_wp,&
   &  1.66067712958550E-02_wp,  2.14662970424062E-02_wp, -9.88508602128069E-03_wp,&
   & -2.14525046789376E-02_wp, -5.02370916894070E-03_wp, -1.76657701472139E-02_wp,&
   & -8.94744996181654E-06_wp, -1.45010649086251E-02_wp,  1.77106428273027E-05_wp,&
   & -1.45012041254701E-02_wp,  2.50307291871933E-06_wp,  1.80042165410527E-02_wp,&
   & -1.86686039162968E-05_wp,  1.80070884032040E-02_wp, -1.10668089904718E-03_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp, -1.11022302462516E-16_wp,  0.00000000000000E+00_wp,&
   &  9.99999999954551E-01_wp,  2.63800014792315E-02_wp, -3.41583394328134E-02_wp,&
   &  1.63613596495745E-02_wp, -3.01259978843215E-02_wp,  3.79195137214651E-02_wp,&
   & -1.42493120183091E-02_wp, -6.15438065835367E-03_wp, -1.58332148385133E-02_wp,&
   &  9.22879030090662E-03_wp,  2.64749408444800E-02_wp,  4.33119817905521E-02_wp,&
   &  1.63802514706332E-02_wp, -1.43716014597182E-02_wp, -1.07769287086904E-02_wp,&
   &  2.08556539310093E-02_wp, -6.20765068313604E-03_wp, -4.34789036427403E-03_wp,&
   & -3.75393655796224E-02_wp,  1.30104992059389E-03_wp,  3.95580722783222E-03_wp,&
   & -3.00113728729448E-03_wp,  8.00554223579692E-04_wp, -1.82104782406491E-03_wp,&
   & -5.43088248084271E-03_wp,  3.76647504502335E-03_wp, -1.35224387957403E-03_wp,&
   & -1.45625251027269E-03_wp,  8.70332288839526E-02_wp,  1.16497266239664E-01_wp,&
   & -1.16519015649088E-01_wp,  4.33176423690919E-01_wp,  5.25423280348557E-02_wp,&
   & -1.41332261122806E-02_wp, -5.23163316672891E-02_wp, -5.25521374032757E-02_wp,&
   &  9.06198212145744E-02_wp,  2.65262804737233E-02_wp, -1.19396457290750E-02_wp,&
   & -5.49466777496781E-03_wp,  1.76085959125799E-02_wp, -2.04310419716949E-02_wp,&
   & -2.05923224531728E-02_wp,  2.63800014792315E-02_wp,  9.99999999869332E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  1.36826835494556E-04_wp,&
   &  3.80997109097610E-04_wp, -1.97015036935123E-07_wp,  3.80647970903945E-04_wp,&
   &  1.93195069178017E-04_wp, -9.99935284021138E-08_wp, -1.11541242219443E-04_wp,&
   & -9.99018963160668E-08_wp, -1.77121321787578E-07_wp,  1.36853118227325E-04_wp,&
   &  2.05417153540537E-07_wp, -3.81089012990603E-04_wp,  3.80689560798289E-04_wp,&
   &  1.04157546227427E-07_wp, -1.04266837273126E-07_wp,  5.59569695067641E-05_wp,&
   & -1.93232628352530E-04_wp,  9.65150142009483E-05_wp, -3.75743088618795E-02_wp,&
   &  1.27185027273083E-01_wp,  2.23800362362654E-02_wp, -8.32010466694543E-02_wp,&
   &  3.76133234479980E-02_wp, -1.01175114428171E-02_wp,  1.77482357827602E-02_wp,&
   &  2.80724856877327E-02_wp, -6.60715651232787E-02_wp,  1.42507277160613E-02_wp,&
   & -7.13257557069312E-03_wp, -4.51845862183764E-03_wp, -7.89094697640371E-03_wp,&
   &  8.07339184243267E-03_wp,  1.66787249920546E-02_wp, -3.41583394328134E-02_wp,&
   &  0.00000000000000E+00_wp,  9.99999999998060E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   & -3.80997109097610E-04_wp, -7.92264027671747E-04_wp,  4.79291511494016E-07_wp,&
   & -9.26027495971084E-04_wp, -5.12000496363400E-04_wp,  2.65000221759466E-07_wp,&
   &  2.95564415906649E-04_wp,  3.03094223395945E-07_wp, -7.36682501711558E-05_wp,&
   & -2.05417153540537E-07_wp,  1.34636728741005E-04_wp,  4.99757520772504E-07_wp,&
   & -4.99233681904174E-07_wp,  7.41468644567862E-05_wp, -7.42246657169478E-05_wp,&
   & -1.14613485357910E-07_wp,  3.16020075744239E-07_wp, -1.97853536620492E-07_wp,&
   &  3.75813237820884E-02_wp,  2.23800362362654E-02_wp,  1.27176671589586E-01_wp,&
   &  8.32165798547972E-02_wp,  2.80724856877327E-02_wp,  1.01128041839211E-02_wp,&
   & -4.83521202784524E-02_wp,  3.76028424638346E-02_wp,  4.84166524251350E-02_wp,&
   &  1.64520845587426E-02_wp,  7.12847996348055E-03_wp, -8.35290361560678E-03_wp,&
   & -8.49391724326558E-03_wp, -3.10589341057993E-02_wp,  1.22944986258270E-02_wp,&
   &  1.63613596495745E-02_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999998060E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  1.97015036935123E-07_wp,  4.79291511494016E-07_wp,&
   &  1.34612592032630E-04_wp,  4.78852298259674E-07_wp,  3.03094223395945E-07_wp,&
   &  7.42054649723882E-05_wp, -2.19299734079002E-07_wp,  7.41374645561596E-05_wp,&
   & -2.77876913228084E-10_wp,  3.81089012990603E-04_wp,  4.99757520772504E-07_wp,&
   & -7.92510988513406E-04_wp,  9.26176163038800E-04_wp,  3.16020075744239E-07_wp,&
   & -2.76342502531170E-07_wp,  8.40692537630547E-05_wp, -5.12132040120647E-04_wp,&
   &  2.92832187421564E-04_wp, -1.39714048756839E-01_wp, -8.32010466694543E-02_wp,&
   &  8.32165798547972E-02_wp, -1.59808878632637E-01_wp, -8.66996070598103E-02_wp,&
   &  2.80724856877327E-02_wp,  6.59939718017320E-02_wp,  8.67157934074530E-02_wp,&
   & -1.14315393138031E-01_wp, -4.33629885001251E-02_wp,  2.36204873819870E-02_wp,&
   &  8.07339184243267E-03_wp, -2.93412223402838E-02_wp,  2.33299201127748E-02_wp,&
   &  3.29444070689262E-02_wp, -3.01259978843216E-02_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999998060E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -3.80647970903945E-04_wp,&
   & -9.26027495971084E-04_wp,  4.78852298259674E-07_wp, -7.90566062865544E-04_wp,&
   & -5.11395370458502E-04_wp,  3.03094223395945E-07_wp,  2.95293566538459E-04_wp,&
   &  2.64444467933010E-07_wp,  7.46745005267280E-05_wp, -3.80689560798289E-04_wp,&
   & -4.99233681904174E-07_wp,  9.26176163038800E-04_wp, -7.90568359968840E-04_wp,&
   & -2.75679659279210E-07_wp,  3.16020075744239E-07_wp, -2.12407565047160E-04_wp,&
   &  5.11439709126180E-04_wp, -2.18378210003762E-04_wp,  3.45798058538413E-02_wp,&
   & -5.34993759992540E-02_wp, -8.27117190825192E-03_wp,  1.41373024575003E-02_wp,&
   & -3.13928380664618E-02_wp,  1.01062226584647E-02_wp, -1.42536615921013E-02_wp,&
   & -3.23847235694901E-02_wp,  6.52496331395600E-02_wp, -1.06197224047312E-02_wp,&
   &  7.04622324062803E-03_wp,  4.15769532832945E-03_wp,  9.78931808308578E-03_wp,&
   & -6.55604951437516E-03_wp, -2.15444415357697E-02_wp,  3.79195137214650E-02_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  1.93195069178017E-04_wp,  5.12000496363400E-04_wp, -3.03094223395945E-07_wp,&
   &  5.11395370458502E-04_wp,  3.02303796054992E-04_wp, -1.75027739250976E-07_wp,&
   & -1.72005959648326E-04_wp, -1.74829224558890E-07_wp, -3.46859522975048E-07_wp,&
   &  1.04157546227427E-07_wp, -7.41468644567862E-05_wp, -3.16020075744239E-07_wp,&
   &  2.75679659279210E-07_wp, -3.57916867547333E-05_wp,  4.02157038269419E-05_wp,&
   &  8.40985432367323E-08_wp, -1.82274367109096E-07_wp,  1.01880323914275E-07_wp,&
   & -9.30153332236999E-03_wp,  1.43906599905847E-02_wp, -1.43871433346015E-02_wp,&
   & -8.27117190825192E-03_wp,  1.01062226584647E-02_wp,  3.46007075733886E-03_wp,&
   &  1.32819859594181E-02_wp, -1.01005368129228E-02_wp, -2.30060965035419E-02_wp,&
   &  4.30651579672444E-03_wp,  2.18743219017234E-03_wp, -2.99023732449633E-03_wp,&
   &  1.57131827213755E-03_wp,  1.10366762058167E-02_wp, -4.99763652448016E-03_wp,&
   & -1.42493120183091E-02_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp, -9.99935284021138E-08_wp, -2.65000221759466E-07_wp,&
   & -7.42054649723882E-05_wp, -3.03094223395945E-07_wp, -1.75027739250976E-07_wp,&
   & -3.58629600796389E-05_wp,  1.25070937930099E-07_wp, -4.02068969969509E-05_wp,&
   & -2.06307331312157E-08_wp, -1.04266837273126E-07_wp,  7.42246657169478E-05_wp,&
   &  2.76342502531170E-07_wp, -3.16020075744239E-07_wp,  4.02157038269418E-05_wp,&
   & -3.58760380664078E-05_wp, -4.66010359512733E-08_wp,  1.82511140476662E-07_wp,&
   & -1.23687368788150E-07_wp, -3.44310703332351E-02_wp,  1.35687533191727E-03_wp,&
   &  2.74210445204502E-02_wp,  5.04532357407558E-03_wp, -1.42536615921013E-02_wp,&
   &  1.32819859594181E-02_wp,  1.49130511639889E-02_wp,  4.93869372486169E-02_wp,&
   & -2.45833086092492E-02_wp, -6.18850713917029E-03_wp,  1.24379648278380E-02_wp,&
   &  9.35800123003137E-04_wp, -2.06016118679948E-02_wp,  3.47962285860064E-03_wp,&
   &  2.14517740482326E-02_wp, -6.15438065835366E-03_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999830206E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -1.11541242219443E-04_wp,&
   & -2.95564415906649E-04_wp,  2.19299734079002E-07_wp, -2.95293566538459E-04_wp,&
   & -1.72005959648326E-04_wp,  1.25070937930099E-07_wp,  1.03688507015471E-04_wp,&
   &  1.24956325403373E-07_wp,  1.57695137137166E-07_wp,  5.59569695067641E-05_wp,&
   &  1.14613485357910E-07_wp, -8.40692537630547E-05_wp,  2.12407565047160E-04_wp,&
   &  8.40985432367323E-08_wp, -4.66010359512733E-08_wp, -3.09535561363645E-05_wp,&
   & -8.63634200127042E-05_wp,  7.79278351762378E-05_wp, -3.45862617165372E-02_wp,&
   & -8.27117190825192E-03_wp, -5.34962879213849E-02_wp, -1.41399418153943E-02_wp,&
   & -3.23847235694901E-02_wp, -1.01005368129228E-02_wp,  4.93869372486169E-02_wp,&
   & -3.13807470896014E-02_wp, -4.49791451114302E-02_wp, -2.09326136855973E-02_wp,&
   & -7.04080373093204E-03_wp,  1.10366762058167E-02_wp,  5.84269529728235E-03_wp,&
   &  3.50797021692688E-02_wp, -9.78462216776902E-03_wp, -1.58332148385133E-02_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,&
   & -9.99018963160668E-08_wp, -3.03094223395945E-07_wp, -7.41374645561596E-05_wp,&
   & -2.64444467933010E-07_wp, -1.74829224558890E-07_wp, -4.02068969969509E-05_wp,&
   &  1.24956325403373E-07_wp, -3.57892366790223E-05_wp,  2.09705522623049E-08_wp,&
   & -1.93232628352530E-04_wp, -3.16020075744239E-07_wp,  5.12132040120647E-04_wp,&
   & -5.11439709126180E-04_wp, -1.82274367109096E-07_wp,  1.82511140476662E-07_wp,&
   & -8.63634200127042E-05_wp,  3.02362830896077E-04_wp, -1.48792121496412E-04_wp,&
   &  5.96398359439081E-02_wp,  3.08746228065193E-02_wp, -1.42653009029895E-02_wp,&
   & -8.73566869305487E-03_wp,  6.52496331395600E-02_wp, -2.30060965035419E-02_wp,&
   & -2.45833086092492E-02_wp, -4.49791451114302E-02_wp,  4.33108632907898E-02_wp,&
   &  3.75454402983552E-02_wp, -2.15444415357697E-02_wp, -5.55359313937753E-03_wp,&
   &  1.68836495770294E-02_wp, -7.88516878280771E-03_wp, -1.76198085660875E-02_wp,&
   &  9.22879030090662E-03_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999830206E-01_wp, -1.77121321787578E-07_wp,  7.36682501711558E-05_wp,&
   &  2.77876913228083E-10_wp, -7.46745005267280E-05_wp, -3.46859522975068E-07_wp,&
   & -2.06307331312157E-08_wp,  1.57695137137180E-07_wp,  2.09705522623049E-08_wp,&
   & -7.60328860291605E-05_wp,  9.65150142009483E-05_wp,  1.97853536620492E-07_wp,&
   & -2.92832187421564E-04_wp,  2.18378210003762E-04_wp,  1.01880323914275E-07_wp,&
   & -1.23687368788150E-07_wp,  7.79278351762379E-05_wp, -1.48792121496412E-04_wp,&
   &  5.86130857619870E-05_wp,  8.70374037059324E-02_wp, -4.33348901004945E-01_wp,&
   & -1.16237129265320E-01_wp, -1.16159235164929E-01_wp,  5.24117329880226E-02_wp,&
   &  5.24468792661921E-02_wp, -5.23780577961643E-02_wp,  1.40583935212950E-02_wp,&
   & -9.07403055520738E-02_wp,  2.64599835954327E-02_wp, -1.18810440271297E-02_wp,&
   &  2.04857407452728E-02_wp,  1.75766379725733E-02_wp,  5.49120574954626E-03_wp,&
   &  2.05696225603867E-02_wp,  2.64749408444800E-02_wp,  1.36826835494556E-04_wp,&
   & -3.80997109097610E-04_wp,  1.97015036935123E-07_wp, -3.80647970903945E-04_wp,&
   &  1.93195069178017E-04_wp, -9.99935284021138E-08_wp, -1.11541242219443E-04_wp,&
   & -9.99018963160668E-08_wp, -1.77121321787578E-07_wp,  9.99999999869332E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  1.36914816411514E-04_wp,&
   & -3.81031822962775E-04_wp, -3.81060342174962E-04_wp, -3.01199441988957E-08_wp,&
   &  1.52805656852314E-08_wp,  1.93320995224644E-04_wp,  5.58194946609375E-05_wp,&
   &  1.52817093946773E-08_wp, -9.66532627702810E-05_wp,  1.39773340235538E-01_wp,&
   & -1.60044731429357E-01_wp, -8.30463228406609E-02_wp, -8.29906709276329E-02_wp,&
   &  8.65303810973684E-02_wp,  8.65884066704753E-02_wp, -6.61395790598951E-02_wp,&
   &  2.79344703548215E-02_wp, -1.14594563383586E-01_wp,  3.02925797742799E-02_wp,&
   & -2.35164866656702E-02_wp,  2.34445908193347E-02_wp,  2.93054477839701E-02_wp,&
   &  8.08162016536220E-03_wp,  3.29391434621482E-02_wp,  4.33119817905521E-02_wp,&
   &  3.80997109097610E-04_wp, -7.92264027671747E-04_wp,  4.79291511494016E-07_wp,&
   & -9.26027495971084E-04_wp,  5.12000496363400E-04_wp, -2.65000221759466E-07_wp,&
   & -2.95564415906649E-04_wp, -3.03094223395945E-07_wp,  7.36682501711558E-05_wp,&
   &  0.00000000000000E+00_wp,  9.99999999998060E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  3.81031822962775E-04_wp, -7.91763031760038E-04_wp, -9.26526082508415E-04_wp,&
   & -7.32348943600160E-08_wp,  4.04672337001281E-08_wp,  5.11968342929744E-04_wp,&
   &  2.12105747053989E-04_wp,  4.63374172429796E-08_wp, -2.18856620399346E-04_wp,&
   &  3.74913880688911E-02_wp, -8.30463228406609E-02_wp,  1.27288516082972E-01_wp,&
   & -2.22605787670403E-02_wp,  2.79344703548215E-02_wp, -3.77560767510108E-02_wp,&
   & -4.82683419247890E-02_wp, -1.01205217967675E-02_wp, -4.83628804262418E-02_wp,&
   &  1.63709973045090E-02_wp,  7.14679858463501E-03_wp,  3.10252761602399E-02_wp,&
   & -8.56339623412284E-03_wp,  8.31632973153208E-03_wp, -1.23732349670084E-02_wp,&
   &  1.63802514706332E-02_wp, -1.97015036935123E-07_wp,  4.79291511494016E-07_wp,&
   &  1.34612592032630E-04_wp,  4.78852298259674E-07_wp, -3.03094223395945E-07_wp,&
   & -7.42054649723882E-05_wp,  2.19299734079002E-07_wp, -7.41374645561596E-05_wp,&
   &  2.77876913228084E-10_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999998060E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  3.81060342174962E-04_wp, -9.26526082508416E-04_wp,&
   & -7.91901722565114E-04_wp, -7.32403757958591E-08_wp,  4.63374172429796E-08_wp,&
   &  5.12017772660786E-04_wp,  8.35647642012739E-05_wp,  4.04741699038938E-08_wp,&
   & -2.93095338035193E-04_wp,  3.74662639285711E-02_wp, -8.29906709276330E-02_wp,&
   & -2.22605787670403E-02_wp,  1.27318361092920E-01_wp, -3.77935288116399E-02_wp,&
   &  2.79344703548215E-02_wp, -1.77287236679529E-02_wp, -1.01373541820083E-02_wp,&
   & -6.59438527478925E-02_wp,  3.41160014678714E-02_wp,  7.16144651437762E-03_wp,&
   &  8.08162016536220E-03_wp,  7.85532948821966E-03_wp, -4.53878776226461E-03_wp,&
   &  1.66067712958550E-02_wp, -1.43716014597182E-02_wp,  3.80647970903945E-04_wp,&
   & -9.26027495971084E-04_wp,  4.78852298259674E-07_wp, -7.90566062865544E-04_wp,&
   &  5.11395370458502E-04_wp, -3.03094223395945E-07_wp, -2.95293566538459E-04_wp,&
   & -2.64444467933010E-07_wp, -7.46745005267280E-05_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999998060E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  3.01199441988957E-08_wp,&
   & -7.32348943600160E-08_wp, -7.32403757958591E-08_wp,  1.34693702151802E-04_wp,&
   & -7.42167782134206E-05_wp,  4.63374172429796E-08_wp,  1.67666133916467E-08_wp,&
   & -7.42223331406424E-05_wp, -2.90336900614311E-08_wp,  3.44935575376165E-02_wp,&
   & -1.41189238737982E-02_wp, -8.23000940585466E-03_wp,  5.35689685630853E-02_wp,&
   & -3.16124164200931E-02_wp,  3.22421444843218E-02_wp, -1.42605958522703E-02_wp,&
   & -1.01452989469593E-02_wp, -6.51709489914341E-02_wp,  3.79081573845803E-02_wp,&
   &  7.09981307416131E-03_wp,  6.58560842946932E-03_wp,  9.75167393230448E-03_wp,&
   & -4.18109708914812E-03_wp,  2.14662970424062E-02_wp, -1.07769287086904E-02_wp,&
   &  1.93195069178017E-04_wp, -5.12000496363400E-04_wp,  3.03094223395945E-07_wp,&
   & -5.11395370458502E-04_wp,  3.02303796054992E-04_wp, -1.75027739250976E-07_wp,&
   & -1.72005959648326E-04_wp, -1.74829224558890E-07_wp, -3.46859522975048E-07_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  1.52805656852314E-08_wp, -4.04672337001281E-08_wp, -4.63374172429796E-08_wp,&
   &  7.42167782134206E-05_wp, -3.58491990436138E-05_wp,  2.67441225942547E-08_wp,&
   &  1.23128772162410E-08_wp, -4.02365479797492E-05_wp, -1.49612582359721E-08_wp,&
   &  3.45166882394490E-02_wp, -1.41283917466891E-02_wp,  5.35579344963093E-02_wp,&
   & -8.23000940585465E-03_wp,  3.22421444843218E-02_wp, -3.15691890119948E-02_wp,&
   & -4.93307340926079E-02_wp, -1.01249631946354E-02_wp, -4.49724187241898E-02_wp,&
   &  1.58731236606599E-02_wp,  7.08042479432178E-03_wp,  3.50699485040518E-02_wp,&
   & -5.93492587193690E-03_wp,  1.09954165068214E-02_wp, -9.88508602128069E-03_wp,&
   &  2.08556539310093E-02_wp, -9.99935284021138E-08_wp,  2.65000221759466E-07_wp,&
   &  7.42054649723882E-05_wp,  3.03094223395945E-07_wp, -1.75027739250976E-07_wp,&
   & -3.58629600796389E-05_wp,  1.25070937930099E-07_wp, -4.02068969969509E-05_wp,&
   & -2.06307331312157E-08_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  1.93320995224644E-04_wp, -5.11968342929744E-04_wp,&
   & -5.12017772660787E-04_wp, -4.63374172429796E-08_wp,  2.67441225942547E-08_wp,&
   &  3.02502172923347E-04_wp,  8.60837450897409E-05_wp,  2.67466004262761E-08_wp,&
   & -1.49044749285328E-04_wp, -3.44713949968698E-02_wp, -5.01351592133488E-03_wp,&
   &  2.73637142429739E-02_wp, -1.34387366290517E-03_wp, -1.42605958522703E-02_wp,&
   & -4.93307340926079E-02_wp,  1.50253183734119E-02_wp, -1.32231103598817E-02_wp,&
   &  2.46893348343464E-02_wp, -6.20414361666848E-03_wp,  1.23909980280101E-02_wp,&
   & -3.57535465794485E-03_wp, -2.05903301814128E-02_wp, -9.58374329661679E-04_wp,&
   & -2.14525046789376E-02_wp, -6.20765068313604E-03_wp, -1.11541242219443E-04_wp,&
   &  2.95564415906649E-04_wp, -2.19299734079002E-07_wp,  2.95293566538459E-04_wp,&
   & -1.72005959648326E-04_wp,  1.25070937930099E-07_wp,  1.03688507015471E-04_wp,&
   &  1.24956325403373E-07_wp,  1.57695137137166E-07_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999830206E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  5.58194946609375E-05_wp,&
   & -2.12105747053989E-04_wp, -8.35647642012739E-05_wp, -1.67666133916467E-08_wp,&
   &  1.23128772162410E-08_wp,  8.60837450897408E-05_wp, -3.11161774134644E-05_wp,&
   &  6.80477965954110E-09_wp, -7.78819175647245E-05_wp,  9.25220324090528E-03_wp,&
   & -8.23000940585465E-03_wp,  1.43562120353310E-02_wp,  1.43687986955485E-02_wp,&
   & -1.01452989469593E-02_wp, -1.01249631946354E-02_wp, -1.32231103598817E-02_wp,&
   &  3.48945918018274E-03_wp, -2.29067300251207E-02_wp,  1.41986623495980E-02_wp,&
   & -2.21220960578854E-03_wp,  1.09954165068214E-02_wp, -1.59085773252457E-03_wp,&
   & -3.00272708289353E-03_wp, -5.02370916894070E-03_wp, -4.34789036427403E-03_wp,&
   & -9.99018963160668E-08_wp,  3.03094223395945E-07_wp,  7.41374645561596E-05_wp,&
   &  2.64444467933010E-07_wp, -1.74829224558890E-07_wp, -4.02068969969509E-05_wp,&
   &  1.24956325403373E-07_wp, -3.57892366790223E-05_wp,  2.09705522623049E-08_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,&
   &  1.52817093946773E-08_wp, -4.63374172429796E-08_wp, -4.04741699038938E-08_wp,&
   &  7.42223331406424E-05_wp, -4.02365479797492E-05_wp,  2.67466004262761E-08_wp,&
   &  6.80477965954109E-09_wp, -3.58552220140818E-05_wp, -1.81430117310647E-08_wp,&
   & -5.97186120759761E-02_wp, -8.67263023353150E-03_wp,  1.42485952211188E-02_wp,&
   &  3.08027933722347E-02_wp, -6.51709489914341E-02_wp, -4.49724187241898E-02_wp,&
   &  2.46893348343464E-02_wp, -2.29067300251207E-02_wp,  4.35750533924669E-02_wp,&
   & -9.40109730663969E-03_wp,  2.14662970424062E-02_wp, -7.96813580327051E-03_wp,&
   & -1.68830493062253E-02_wp, -5.57049215814083E-03_wp, -1.76657701472139E-02_wp,&
   & -3.75393655796224E-02_wp, -1.77121321787578E-07_wp, -7.36682501711558E-05_wp,&
   & -2.77876913228083E-10_wp,  7.46745005267280E-05_wp, -3.46859522975068E-07_wp,&
   & -2.06307331312157E-08_wp,  1.57695137137180E-07_wp,  2.09705522623049E-08_wp,&
   & -7.60328860291605E-05_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999830206E-01_wp, -9.66532627702810E-05_wp,  2.18856620399346E-04_wp,&
   &  2.93095338035193E-04_wp,  2.90336900614311E-08_wp, -1.49612582359721E-08_wp,&
   & -1.49044749285328E-04_wp, -7.78819175647245E-05_wp, -1.81430117310647E-08_wp,&
   &  5.87843647458168E-05_wp,  8.70501483673078E-02_wp,  1.16210744639605E-01_wp,&
   &  4.33383941745651E-01_wp, -1.16123223564182E-01_wp, -1.40516658129165E-02_wp,&
   &  5.24422775322676E-02_wp,  1.04801175173019E-01_wp, -5.24027820059161E-02_wp,&
   & -1.05866317134433E-05_wp,  1.29811257675896E-03_wp, -1.18759753002141E-02_wp,&
   &  2.70248997746202E-02_wp,  3.34788927546922E-02_wp, -2.70045466799145E-02_wp,&
   & -8.94744996181654E-06_wp,  1.30104992059389E-03_wp,  1.36853118227325E-04_wp,&
   & -2.05417153540537E-07_wp,  3.81089012990603E-04_wp, -3.80689560798289E-04_wp,&
   &  1.04157546227427E-07_wp, -1.04266837273126E-07_wp,  5.59569695067641E-05_wp,&
   & -1.93232628352530E-04_wp,  9.65150142009483E-05_wp,  1.36914816411514E-04_wp,&
   &  3.81031822962775E-04_wp,  3.81060342174962E-04_wp,  3.01199441988957E-08_wp,&
   &  1.52805656852314E-08_wp,  1.93320995224644E-04_wp,  5.58194946609375E-05_wp,&
   &  1.52817093946773E-08_wp, -9.66532627702810E-05_wp,  9.99999999869332E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -3.74858754537407E-02_wp,&
   &  1.27309830624938E-01_wp, -8.30281095559713E-02_wp,  2.22469980988311E-02_wp,&
   & -1.01228452820915E-02_wp,  3.77795108969692E-02_wp, -6.60161665311768E-02_wp,&
   &  2.79218478854371E-02_wp, -1.76176457256347E-02_wp, -8.06516718402946E-04_wp,&
   & -7.14994912355814E-03_wp,  1.50402860974054E-02_wp, -3.19446824256199E-02_wp,&
   &  1.79324690622517E-02_wp, -1.45010649086251E-02_wp,  3.95580722783221E-03_wp,&
   &  2.05417153540537E-07_wp,  1.34636728741005E-04_wp,  4.99757520772504E-07_wp,&
   & -4.99233681904174E-07_wp, -7.41468644567862E-05_wp,  7.42246657169478E-05_wp,&
   &  1.14613485357910E-07_wp, -3.16020075744239E-07_wp,  1.97853536620492E-07_wp,&
   & -3.81031822962775E-04_wp, -7.91763031760038E-04_wp, -9.26526082508415E-04_wp,&
   & -7.32348943600160E-08_wp, -4.04672337001281E-08_wp, -5.11968342929744E-04_wp,&
   & -2.12105747053989E-04_wp, -4.63374172429796E-08_wp,  2.18856620399346E-04_wp,&
   &  0.00000000000000E+00_wp,  9.99999999998060E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   & -1.39795821068959E-01_wp, -8.30281095559713E-02_wp, -1.60062569705741E-01_wp,&
   &  8.29655791121539E-02_wp,  2.79218478854371E-02_wp, -8.65839522640561E-02_wp,&
   & -1.32359100461928E-01_wp,  8.65187438305329E-02_wp,  2.10365321989047E-05_wp,&
   & -2.99436170399896E-03_wp,  2.35073856423452E-02_wp, -4.39888913409343E-02_wp,&
   & -3.83315557436565E-02_wp,  4.39557622607554E-02_wp,  1.77106428272954E-05_wp,&
   & -3.00113728729448E-03_wp, -3.81089012990603E-04_wp,  4.99757520772504E-07_wp,&
   & -7.92510988513406E-04_wp,  9.26176163038800E-04_wp, -3.16020075744239E-07_wp,&
   &  2.76342502531170E-07_wp, -8.40692537630547E-05_wp,  5.12132040120647E-04_wp,&
   & -2.92832187421564E-04_wp, -3.81060342174962E-04_wp, -9.26526082508416E-04_wp,&
   & -7.91901722565114E-04_wp, -7.32403757958591E-08_wp, -4.63374172429796E-08_wp,&
   & -5.12017772660786E-04_wp, -8.35647642012739E-05_wp, -4.04741699038938E-08_wp,&
   &  2.93095338035193E-04_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999998060E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  3.74576439494761E-02_wp,  2.22469980988311E-02_wp,&
   &  8.29655791121539E-02_wp,  1.27343352739503E-01_wp,  1.01417565632354E-02_wp,&
   &  2.79218478854371E-02_wp,  6.59664481862163E-02_wp,  3.78215839613670E-02_wp,&
   & -1.76156507407620E-02_wp, -3.95822878810612E-03_wp,  7.16640662849692E-03_wp,&
   &  1.79324690622517E-02_wp,  3.19206241256012E-02_wp,  1.50673070140999E-02_wp,&
   & -1.45012041254701E-02_wp,  8.00554223579692E-04_wp,  3.80689560798289E-04_wp,&
   & -4.99233681904174E-07_wp,  9.26176163038800E-04_wp, -7.90568359968840E-04_wp,&
   &  2.75679659279210E-07_wp, -3.16020075744239E-07_wp,  2.12407565047160E-04_wp,&
   & -5.11439709126180E-04_wp,  2.18378210003762E-04_wp, -3.01199441988957E-08_wp,&
   & -7.32348943600160E-08_wp, -7.32403757958591E-08_wp,  1.34693702151802E-04_wp,&
   &  7.42167782134206E-05_wp, -4.63374172429796E-08_wp, -1.67666133916467E-08_wp,&
   &  7.42223331406424E-05_wp,  2.90336900614311E-08_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999998060E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -9.24753044651747E-03_wp,&
   &  1.43530502027905E-02_wp, -8.22477070533191E-03_wp, -1.43671911792981E-02_wp,&
   &  3.49370165331896E-03_wp,  1.01292406544861E-02_wp, -2.64395429758220E-02_wp,&
   & -1.01520886025437E-02_wp,  2.03821043514362E-06_wp, -1.81912873599402E-03_wp,&
   &  2.21565288441125E-03_wp,  4.95028725981733E-03_wp, -1.79536250204066E-02_wp,&
   & -4.96682678308068E-03_wp,  2.50307291871889E-06_wp, -1.82104782406491E-03_wp,&
   &  1.04157546227427E-07_wp,  7.41468644567862E-05_wp,  3.16020075744239E-07_wp,&
   & -2.75679659279210E-07_wp, -3.57916867547333E-05_wp,  4.02157038269419E-05_wp,&
   &  8.40985432367323E-08_wp, -1.82274367109096E-07_wp,  1.01880323914275E-07_wp,&
   &  1.52805656852314E-08_wp,  4.04672337001281E-08_wp,  4.63374172429796E-08_wp,&
   & -7.42167782134206E-05_wp, -3.58491990436138E-05_wp,  2.67441225942547E-08_wp,&
   &  1.23128772162410E-08_wp, -4.02365479797492E-05_wp, -1.49612582359721E-08_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  3.45127449386520E-02_wp, -5.35670754052100E-02_wp,  1.41247188002737E-02_wp,&
   & -8.22477070533191E-03_wp,  1.01292406544861E-02_wp, -3.15955942345220E-02_wp,&
   &  6.36166321182948E-02_wp, -3.22294844459063E-02_wp,  2.02334222574644E-02_wp,&
   &  1.36043029532046E-03_wp,  7.08602157655659E-03_wp, -1.14665040868790E-02_wp,&
   &  3.40326382516863E-02_wp, -2.29355875181754E-02_wp,  1.80042165410527E-02_wp,&
   & -5.43088248084271E-03_wp, -1.04266837273126E-07_wp, -7.42246657169478E-05_wp,&
   & -2.76342502531170E-07_wp,  3.16020075744239E-07_wp,  4.02157038269418E-05_wp,&
   & -3.58760380664078E-05_wp, -4.66010359512733E-08_wp,  1.82511140476662E-07_wp,&
   & -1.23687368788150E-07_wp,  1.93320995224644E-04_wp,  5.11968342929744E-04_wp,&
   &  5.12017772660787E-04_wp,  4.63374172429796E-08_wp,  2.67441225942547E-08_wp,&
   &  3.02502172923347E-04_wp,  8.60837450897409E-05_wp,  2.67466004262761E-08_wp,&
   & -1.49044749285328E-04_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  6.89706168041974E-02_wp,  2.60161126016657E-02_wp,&
   & -1.00156415719286E-02_wp, -2.59965192485702E-02_wp, -2.64395429758220E-02_wp,&
   &  6.36166321182948E-02_wp,  5.78592563648317E-02_wp, -6.35687209197645E-02_wp,&
   & -1.99197524253163E-05_wp,  3.75797158018484E-03_wp, -2.47788900687522E-02_wp,&
   &  3.58408964505242E-02_wp,  1.42340764508628E-02_wp, -3.58139038190666E-02_wp,&
   & -1.86686039163034E-05_wp,  3.76647504502335E-03_wp,  5.59569695067641E-05_wp,&
   & -1.14613485357910E-07_wp,  8.40692537630547E-05_wp, -2.12407565047160E-04_wp,&
   &  8.40985432367323E-08_wp, -4.66010359512733E-08_wp, -3.09535561363645E-05_wp,&
   & -8.63634200127042E-05_wp,  7.79278351762378E-05_wp,  5.58194946609375E-05_wp,&
   &  2.12105747053989E-04_wp,  8.35647642012739E-05_wp,  1.67666133916467E-08_wp,&
   &  1.23128772162410E-08_wp,  8.60837450897408E-05_wp, -3.11161774134644E-05_wp,&
   &  6.80477965954110E-09_wp, -7.78819175647245E-05_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  9.99999999830206E-01_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp, -3.44867525696831E-02_wp,&
   & -8.22477070533192E-03_wp, -1.41140811386419E-02_wp, -5.35794686146051E-02_wp,&
   & -1.01520886025437E-02_wp, -3.22294844459063E-02_wp, -6.35687209197645E-02_wp,&
   & -3.16441581111023E-02_wp,  2.02333861546885E-02_wp,  5.43496998180260E-03_wp,&
   & -7.10780590000309E-03_wp, -2.29355875181754E-02_wp, -3.40070074624808E-02_wp,&
   & -1.15010637784371E-02_wp,  1.80070884032040E-02_wp, -1.35224387957403E-03_wp,&
   & -1.93232628352530E-04_wp,  3.16020075744239E-07_wp, -5.12132040120647E-04_wp,&
   &  5.11439709126180E-04_wp, -1.82274367109096E-07_wp,  1.82511140476662E-07_wp,&
   & -8.63634200127042E-05_wp,  3.02362830896077E-04_wp, -1.48792121496412E-04_wp,&
   &  1.52817093946773E-08_wp,  4.63374172429796E-08_wp,  4.04741699038938E-08_wp,&
   & -7.42223331406424E-05_wp, -4.02365479797492E-05_wp,  2.67466004262761E-08_wp,&
   &  6.80477965954109E-09_wp, -3.58552220140818E-05_wp, -1.81430117310647E-08_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  9.99999999830205E-01_wp,  0.00000000000000E+00_wp,&
   & -6.96715965208249E-06_wp,  1.65693188619463E-02_wp, -6.19660469761483E-06_wp,&
   &  1.65601608170334E-02_wp,  2.03821043514189E-06_wp,  2.02334222574644E-02_wp,&
   & -1.99197524253221E-05_wp,  2.02333861546885E-02_wp,  7.88380791176994E-04_wp,&
   &  1.45680204889244E-03_wp,  2.50307291871968E-06_wp,  1.34544223241853E-02_wp,&
   & -1.35263974067451E-05_wp,  1.34570883666659E-02_wp, -1.10668089904718E-03_wp,&
   & -1.45625251027269E-03_wp,  9.65150142009483E-05_wp, -1.97853536620492E-07_wp,&
   &  2.92832187421564E-04_wp, -2.18378210003762E-04_wp,  1.01880323914275E-07_wp,&
   & -1.23687368788150E-07_wp,  7.79278351762379E-05_wp, -1.48792121496412E-04_wp,&
   &  5.86130857619870E-05_wp, -9.66532627702810E-05_wp, -2.18856620399346E-04_wp,&
   & -2.93095338035193E-04_wp, -2.90336900614311E-08_wp, -1.49612582359721E-08_wp,&
   & -1.49044749285328E-04_wp, -7.78819175647245E-05_wp, -1.81430117310647E-08_wp,&
   &  5.87843647458168E-05_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,  0.00000000000000E+00_wp,&
   &  9.99999999830206E-01_wp],&
   & shape(overlap))

   type(structure_type) :: mol

   call get_structure(mol, "MB16-43", "CeCl3")
   call test_overlap_diat_mol(error, mol, overlap)

end subroutine test_overlap_diat_cecl3

subroutine test_overlap_grad_ss(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(1, 1), doverlapi(3, 1, 1), doverlapj(3, 1, 1), sr(1, 1), sl(1, 1)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 2, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 1, 0, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   do i = 1, 3
      call check(error, doverlapi(i, 1, 1), -doverlapj(i, 1, 1), thr=thr)
      if (allocated(error)) exit
   end do
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   do i = 1, 3
      call check(error, doverlapi(i, 1, 1), doverlapj(i, 1, 1), thr=thr)
      if (allocated(error)) exit
   end do
   if (allocated(error)) return

end subroutine test_overlap_grad_ss


subroutine test_overlap_grad_pp(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i, j, k
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(3, 3), doverlapi(3, 3, 3), doverlapj(3, 3, 3), sr(3, 3), sl(3, 3)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 3, 1, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 2, 1, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   lp: do i = 1, 3
      do j = 1, 3
         do k = 1, 3
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit
         end do
      end do
   end do lp
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   num: do i = 1, 3
      do j = 1, 3
         do k = 1, 3
            call check(error, doverlapi(i, j, k), doverlapj(i, j, k), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_grad_pp


subroutine test_overlap_grad_dd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i, j, k
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(5, 5), doverlapi(3, 5, 5), doverlapj(3, 5, 5), sl(5, 5), sr(5, 5)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 4, 2, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   lp: do i = 1, 3
      do j = 1, 5
         do k = 1, 5
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit lp
         end do
      end do
   end do lp
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   num: do i = 1, 3
      do j = 1, 5
         do k = 1, 5
            call check(error, doverlapi(i, j, k), doverlapj(i, j, k), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_grad_dd


subroutine test_overlap_grad_ff(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6
   integer :: stat, i, j, k
   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3), r2
   real(wp) :: overlap(7, 7), doverlapi(3, 7, 7), doverlapj(3, 7, 7), sl(7, 7), sr(7, 7)
   real(wp), parameter :: step = 1.0e-6_wp

   call slater_to_gauss(ng, 5, 3, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   r2 = sum(vec**2)

   call overlap_grad_cgto(cgtoi, cgtoj, r2, vec, 100.0_wp, overlap, doverlapj)

   vec(:) = -vec

   call overlap_grad_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, overlap, doverlapi)

   lp: do i = 1, 3
      do j = 1, 7
         do k = 1, 7
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit lp
         end do
      end do
   end do lp
   if (allocated(error)) return

   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sr)
      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto(cgtoj, cgtoi, r2, vec, 100.0_wp, sl)
      vec(i) = vec(i) + step
      doverlapj(i, :, :) = 0.5_wp * (sr - sl) / step
   end do

   num: do i = 1, 3
      do j = 1, 7
         do k = 1, 7
            call check(error, doverlapi(i, j, k), doverlapj(i, j, k), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_grad_ff

subroutine test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)
   !> Vector between the two centers
   real(wp), intent(inout) :: vec(3)
   !> Scaling factors for the diatomic frame overlap
   real(wp), intent(in) :: ksig, kpi, kdel
   !> CGTOs for the tested diatomic frame overlap calculation
   type(cgto_type), intent(in) :: cgtoi, cgtoj
   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer :: stat, i, j, k
   real(wp) :: r2
   real(wp) :: overlap(msao(cgtoi%ang), msao(cgtoj%ang)), overlap_scaled(msao(cgtoi%ang), msao(cgtoj%ang)), &
   & sl(msao(cgtoj%ang), msao(cgtoi%ang)), sr(msao(cgtoj%ang), msao(cgtoi%ang)), &
   & sl_scaled(msao(cgtoj%ang), msao(cgtoi%ang)), sr_scaled(msao(cgtoj%ang), msao(cgtoi%ang))

   real(wp) :: doverlapi(3, msao(cgtoi%ang), msao(cgtoj%ang)),  doverlapi_scaled(3, msao(cgtoi%ang), msao(cgtoj%ang)), &
   & doverlapj(3, msao(cgtoj%ang), msao(cgtoi%ang)), doverlapj_scaled(3, msao(cgtoj%ang), msao(cgtoi%ang)), &
   & doverlaptmp(3, msao(cgtoj%ang), msao(cgtoi%ang)), doverlaptmp_scaled(3, msao(cgtoj%ang), msao(cgtoi%ang))

   real(wp), parameter :: step = 1.0e-6_wp

   r2 = sum(vec**2)
   
   ! Test antisymmetry w.r.t. the exchange of the two centers
   call overlap_grad_cgto_diat_scal(cgtoi, cgtoj, r2, vec, 100.0_wp, & 
   & ksig, kpi, kdel, overlap, doverlapi, overlap_scaled, doverlapi_scaled)

   vec(:) = -vec

   call overlap_grad_cgto_diat_scal(cgtoj, cgtoi, r2, vec, 100.0_wp, & 
   & ksig, kpi, kdel, overlap, doverlapj, overlap_scaled, doverlapj_scaled)

   lp: do i = 1, 3
      do j = 1, msao(cgtoi%ang)
         do k = 1, msao(cgtoj%ang)
            call check(error, doverlapi(i, j, k), -doverlapj(i, k, j), thr=thr)
            if (allocated(error)) exit lp
            call check(error, doverlapi_scaled(i, j, k), -doverlapj_scaled(i, k, j), thr=thr)
            if (allocated(error)) exit lp
         end do
      end do
   end do lp
   if (allocated(error)) return

   ! Test the analytical againts the numerical gradient
   do i = 1, 3
      vec(i) = vec(i) + step
      r2 = sum(vec**2)
      call overlap_cgto_diat_scal(cgtoj, cgtoi, r2, vec,&
      & 100.0_wp, ksig, kpi, kdel, sr, sr_scaled)

      vec(i) = vec(i) - 2*step
      r2 = sum(vec**2)
      call overlap_cgto_diat_scal(cgtoj, cgtoi, r2, vec,&
      & 100.0_wp, ksig, kpi, kdel, sl, sl_scaled)

      vec(i) = vec(i) + step
      doverlaptmp(i, :, :) = 0.5_wp * (sr - sl) / step
      doverlaptmp_scaled(i, :, :) = 0.5_wp * (sr_scaled - sl_scaled) / step
   end do

   num: do i = 1, 3
      do j = 1, msao(cgtoi%ang) 
         do k = 1, msao(cgtoj%ang)
            call check(error, doverlapj(i, k, j), doverlaptmp(i, k, j), thr=thr)
            if (allocated(error)) exit num
            call check(error, doverlapj_scaled(i, k, j), doverlaptmp_scaled(i, k, j), thr=thr)
            if (allocated(error)) exit num
         end do
      end do
   end do num
   if (allocated(error)) return

end subroutine test_overlap_diat_grad_gen

subroutine test_overlap_diat_grad_ss(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 2, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 1, 0, 2.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ss

subroutine test_overlap_diat_grad_ss_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 2, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 1, 0, 2.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ss_z

subroutine test_overlap_diat_grad_sp(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 1, 2.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sp

subroutine test_overlap_diat_grad_sp_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 1, 2.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sp_z

subroutine test_overlap_diat_grad_pp(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 3, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 2, 1, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pp

subroutine test_overlap_diat_grad_pp_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 3, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 2, 1, 1.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pp_z

subroutine test_overlap_diat_grad_sd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat


   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.8_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sd

subroutine test_overlap_diat_grad_sd_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 0, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.8_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sd_z

subroutine test_overlap_diat_grad_pd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.5_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pd

subroutine test_overlap_diat_grad_pd_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 1, 1.5_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.5_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pd_z

subroutine test_overlap_diat_grad_dd(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 2, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.3_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.7
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.7_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_dd

subroutine test_overlap_diat_grad_dd_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 4, 2, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 3, 2, 1.3_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.7_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_dd_z

subroutine test_overlap_diat_grad_sf(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 0, 2.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sf

subroutine test_overlap_diat_grad_sf_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 0, 2.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_sf_z

subroutine test_overlap_diat_grad_pf(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat, i

   call slater_to_gauss(ng, 5, 1, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 2.0_wp, cgtoj, .true., stat)


   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp
   
   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pf

subroutine test_overlap_diat_grad_pf_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 1, 1.0_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 2.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_pf_z

subroutine test_overlap_diat_grad_df(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat
   
   call slater_to_gauss(ng, 5, 2, 1.3_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.4_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_df

subroutine test_overlap_diat_grad_df_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat
   
   call slater_to_gauss(ng, 5, 2, 1.3_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.4_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_df_z

subroutine test_overlap_diat_grad_ff(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 3, 1.6_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Randomly oriented vector of length 0.5
   call random_number(vec)
   vec = (vec - 0.5_wp)*(sum(vec**2))*0.5_wp
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.1_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ff

subroutine test_overlap_diat_grad_ff_z(error)

   !> Error handling
   type(error_type), allocatable, intent(out) :: error

   integer, parameter :: ng = 6

   type(cgto_type) :: cgtoi, cgtoj
   real(wp) :: vec(3)
   real(wp) :: ksig, kpi, kdel
   integer :: stat

   call slater_to_gauss(ng, 5, 3, 1.6_wp, cgtoi, .true., stat)
   call slater_to_gauss(ng, 4, 3, 1.0_wp, cgtoj, .true., stat)

   ! Vector along the z-axis to test the ill-defined gradient
   vec(1) = 0.0_wp
   vec(2) = 0.0_wp   
   vec(3) = 0.5_wp

   ksig = 0.1_wp
   kpi = 0.2_wp
   kdel = 0.5_wp

   call test_overlap_diat_grad_gen(vec, ksig, kpi, kdel, cgtoi, cgtoj, error)

end subroutine test_overlap_diat_grad_ff_z

end module test_integral_overlap
