! This file is part of tblite.
! SPDX-Identifier: LGPL-3.0-or-later
!
! tblite is free software: you can redistribute it and/or modify it under
! the terms of the GNU Lesser General Public License as published by
! the Free Software Foundation, either version 3 of the License, or
! (at your option) any later version.
!
! tblite is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU Lesser General Public License for more details.
!
! You should have received a copy of the GNU Lesser General Public License
! along with tblite.  If not, see <https://www.gnu.org/licenses/>.

!> @file tblite/data/spin.f90
!> Provides spin constants for all elements

!> Spin constants
module tblite_data_spin
   use mctc_env, only : wp
   use mctc_io_symbols, only : to_number
   implicit none
   private

   public :: get_spin_constant


   !> Get spin constant for species
   interface get_spin_constant
      module procedure :: get_spin_constant_symbol
      module procedure :: get_spin_constant_number
   end interface get_spin_constant

   integer, parameter :: lidx(0:2, 0:2) = reshape(& ! ss sp sd  sp pp pd  sd pd dd
      & [1, 2, 4,  2, 3, 5,  4, 5, 6], shape(lidx))

   real(wp), parameter :: spin_constants(6, 86) = reshape([&  ! ss, sp, pp, sd, pd, dd
      -0.0716250_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0865500_wp,-0.0386620_wp,-0.0674250_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0177750_wp,-0.0139500_wp,-0.0180250_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0229750_wp,-0.0186250_wp,-0.0175750_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0273250_wp,-0.0220370_wp,-0.0196000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0305000_wp,-0.0250370_wp,-0.0226750_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0330750_wp,-0.0275000_wp,-0.0254500_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0351000_wp,-0.0295500_wp,-0.0278500_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0368000_wp,-0.0312120_wp,-0.0299000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0384000_wp,-0.0326500_wp,-0.0316500_wp,-0.0141120_wp,-0.0153000_wp,-0.0414500_wp, &
      -0.0151000_wp,-0.0133370_wp,-0.0229250_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0166000_wp,-0.0131870_wp,-0.0175000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0182500_wp,-0.0138370_wp,-0.0140000_wp,-0.0081870_wp,-0.0116370_wp,-0.0128750_wp, &
      -0.0195250_wp,-0.0150000_wp,-0.0143750_wp,-0.0084370_wp,-0.0116250_wp,-0.0140750_wp, &
      -0.0205750_wp,-0.0161120_wp,-0.0149000_wp,-0.0092620_wp,-0.0119750_wp,-0.0148250_wp, &
      -0.0213250_wp,-0.0170120_wp,-0.0155000_wp,-0.0099870_wp,-0.0121370_wp,-0.0149500_wp, &
      -0.0218250_wp,-0.0177120_wp,-0.0160500_wp,-0.0109870_wp,-0.0126120_wp,-0.0150750_wp, &
      -0.0222750_wp,-0.0183620_wp,-0.0166500_wp,-0.0118370_wp,-0.0131750_wp,-0.0153250_wp, &
      -0.0106500_wp,-0.0109000_wp,-0.0163750_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0118000_wp,-0.0104500_wp,-0.0134500_wp,-0.0055000_wp,-0.0035120_wp,-0.0101750_wp, &
      -0.0127250_wp,-0.0109120_wp,-0.0138500_wp,-0.0047870_wp,-0.0024120_wp,-0.0125250_wp, &
      -0.0134250_wp,-0.0112250_wp,-0.0146500_wp,-0.0043370_wp,-0.0019750_wp,-0.0138750_wp, &
      -0.0140750_wp,-0.0114500_wp,-0.0152750_wp,-0.0040500_wp,-0.0016620_wp,-0.0149250_wp, &
      -0.0151750_wp,-0.0124370_wp,-0.0212250_wp,-0.0041750_wp,-0.0016750_wp,-0.0138750_wp, &
      -0.0149000_wp,-0.0117870_wp,-0.0168250_wp,-0.0034870_wp,-0.0012620_wp,-0.0165000_wp, &
      -0.0154000_wp,-0.0120250_wp,-0.0177500_wp,-0.0032870_wp,-0.0011620_wp,-0.0171250_wp, &
      -0.0157000_wp,-0.0120870_wp,-0.0186000_wp,-0.0031500_wp,-0.0010620_wp,-0.0177500_wp, &
      -0.0161500_wp,-0.0121500_wp,-0.0196250_wp,-0.0030370_wp,-0.0009000_wp,-0.0183000_wp, &
      -0.0171500_wp,-0.0131870_wp,-0.0303750_wp,-0.0027750_wp,-0.0006500_wp,-0.0173750_wp, &
      -0.0168500_wp,-0.0123250_wp,-0.0214500_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0172250_wp,-0.0128620_wp,-0.0134250_wp,-0.0085250_wp,-0.0129750_wp,-0.0157500_wp, &
      -0.0175750_wp,-0.0133620_wp,-0.0135500_wp,-0.0081250_wp,-0.0127750_wp,-0.0174250_wp, &
      -0.0178750_wp,-0.0137750_wp,-0.0135750_wp,-0.0080500_wp,-0.0123370_wp,-0.0176500_wp, &
      -0.0179750_wp,-0.0140870_wp,-0.0136250_wp,-0.0081620_wp,-0.0120250_wp,-0.0172000_wp, &
      -0.0181000_wp,-0.0143750_wp,-0.0136750_wp,-0.0082250_wp,-0.0117750_wp,-0.0167750_wp, &
      -0.0181500_wp,-0.0145620_wp,-0.0136750_wp,-0.0087250_wp,-0.0118500_wp,-0.0165250_wp, &
      -0.0095500_wp,-0.0095870_wp,-0.0167000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0105750_wp,-0.0092870_wp,-0.0124500_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0113500_wp,-0.0093750_wp,-0.0124250_wp,-0.0067500_wp,-0.0039250_wp,-0.0097250_wp, &
      -0.0118500_wp,-0.0095870_wp,-0.0134500_wp,-0.0061250_wp,-0.0031250_wp,-0.0107250_wp, &
      -0.0125750_wp,-0.0102620_wp,-0.0191750_wp,-0.0060620_wp,-0.0029250_wp,-0.0104750_wp, &
      -0.0129000_wp,-0.0105000_wp,-0.0222500_wp,-0.0055750_wp,-0.0024250_wp,-0.0109000_wp, &
      -0.0131250_wp,-0.0106870_wp,-0.0246250_wp,-0.0051250_wp,-0.0020750_wp,-0.0113000_wp, &
      -0.0133500_wp,-0.0107620_wp,-0.0276000_wp,-0.0047370_wp,-0.0017370_wp,-0.0116000_wp, &
      -0.0135500_wp,-0.0108500_wp,-0.0320500_wp,-0.0043750_wp,-0.0014250_wp,-0.0118750_wp, &
      -0.0189750_wp,-0.0239750_wp,-0.1802750_wp,-0.0020870_wp,-0.0015370_wp,-0.0113250_wp, &
      -0.0139250_wp,-0.0110500_wp,-0.0398000_wp,-0.0038750_wp,-0.0009620_wp,-0.0124000_wp, &
      -0.0138500_wp,-0.0104870_wp,-0.0196750_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0141250_wp,-0.0105620_wp,-0.0115500_wp,-0.0050500_wp,-0.0093750_wp,-0.0101000_wp, &
      -0.0143000_wp,-0.0109120_wp,-0.0116750_wp,-0.0046500_wp,-0.0091250_wp,-0.0118750_wp, &
      -0.0145250_wp,-0.0111250_wp,-0.0116500_wp,-0.0043750_wp,-0.0087250_wp,-0.0124250_wp, &
      -0.0145250_wp,-0.0112370_wp,-0.0115500_wp,-0.0041870_wp,-0.0081620_wp,-0.0122500_wp, &
      -0.0145750_wp,-0.0113370_wp,-0.0114500_wp,-0.0045000_wp,-0.0083120_wp,-0.0128250_wp, &
      -0.0146500_wp,-0.0114750_wp,-0.0114500_wp,-0.0049250_wp,-0.0085250_wp,-0.0133000_wp, &
      -0.0082000_wp,-0.0085370_wp,-0.0153000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0092500_wp,-0.0082870_wp,-0.0113500_wp,-0.0064000_wp,-0.0042870_wp,-0.0078250_wp, &
      -0.0099000_wp,-0.0083750_wp,-0.0114750_wp,-0.0059370_wp,-0.0033750_wp,-0.0090250_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0100000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0121750_wp,-0.0096750_wp,-0.0126250_wp,-0.0076250_wp,-0.0041120_wp,-0.0104250_wp, &
      -0.0123000_wp,-0.0095620_wp,-0.0135000_wp,-0.0071370_wp,-0.0034620_wp,-0.0109250_wp, &
      -0.0125000_wp,-0.0095120_wp,-0.0144500_wp,-0.0066870_wp,-0.0029250_wp,-0.0112500_wp, &
      -0.0126000_wp,-0.0096620_wp,-0.0148000_wp,-0.0063000_wp,-0.0026000_wp,-0.0114500_wp, &
      -0.0127000_wp,-0.0092120_wp,-0.0205000_wp,-0.0059370_wp,-0.0020620_wp,-0.0115500_wp, &
      -0.0127250_wp,-0.0092750_wp,-0.0210000_wp,-0.0056870_wp,-0.0019120_wp,-0.0116750_wp, &
      -0.0130750_wp,-0.0102250_wp,-0.0335500_wp,-0.0055620_wp,-0.0018000_wp,-0.0111000_wp, &
      -0.0131750_wp,-0.0100250_wp,-0.0530000_wp,-0.0053370_wp,-0.0014750_wp,-0.0111750_wp, &
      -0.0129250_wp,-0.0091870_wp,-0.0291500_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0132500_wp,-0.0091120_wp,-0.0107250_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0134750_wp,-0.0094000_wp,-0.0109750_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0136250_wp,-0.0095370_wp,-0.0109750_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0137250_wp,-0.0096250_wp,-0.0108500_wp, 0.0000000_wp, 0.0000000_wp, 0.0000000_wp, &
      -0.0138750_wp,-0.0097500_wp,-0.0107250_wp,-0.0025750_wp,-0.0073500_wp,-0.0119250_wp, &
      -0.0139000_wp,-0.0097370_wp,-0.0106500_wp,-0.0028750_wp,-0.0078120_wp,-0.0130000_wp], &
      shape(spin_constants))

contains


!> Get spin constant for species with a given symbol
elemental function get_spin_constant_symbol(jang, iang, symbol) result(wll)

   !> Angular momentum of shells
   integer, intent(in) :: jang, iang

   !> Element symbol
   character(len=*), intent(in) :: symbol

   !> Spin constant
   real(wp) :: wll

   wll = get_spin_constant(jang, iang, to_number(symbol))

end function get_spin_constant_symbol


!> Get spin constant for species with a given atomic number
elemental function get_spin_constant_number(jang, iang, number) result(wll)

   !> Angular momentum of shells
   integer, intent(in) :: jang, iang

   !> Atomic number
   integer, intent(in) :: number

   !> Spin constant
   real(wp) :: wll

   if (number > 0 .and. number <= size(spin_constants, dim=2)) then
      wll = spin_constants(lidx(jang, iang), number)
   else
      wll = -1.0_wp
   end if

end function get_spin_constant_number


end module tblite_data_spin
